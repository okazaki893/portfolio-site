<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contact</title>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-0VSVT7TT4R"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-0VSVT7TT4R');
  </script>
  <link rel="icon" type="image/png" href="favicon.png">
  <!-- OGP -->
  <meta property="og:title" content="Contact - Noumenon">
  <meta property="og:description" content="お問い合わせ">
  <meta property="og:image" content="https://noumenon.jp/OGP.png">
  <meta property="og:url" content="https://noumenon.jp/contact">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Contact - Noumenon">
  <meta name="twitter:description" content="お問い合わせ">
  <meta name="twitter:image" content="https://noumenon.jp/OGP.png">
  <link rel="stylesheet" href="theme.css">
  <link rel="stylesheet" href="price.css">
  <script src="theme.js"></script>
</head>
<body>
  <div class="price-page">
    <!-- Hamburger Menu Button -->
    <div class="hamburger-menu" onclick="toggleMobileMenu()">
      <span></span>
      <span></span>
      <span></span>
    </div>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay">
      <ul class="mobile-menu-list">
        <li><a href="/">TOP</a></li>
        <li><a href="mixing">Mixing</a></li>
        <li><a href="3danimation">3D Animation</a></li>
        <li><a href="music">Music</a></li>
        <li><a href="planning">Planning Progress</a></li>
        <li><a href="price">Price</a></li>
        <li><a href="tools">Tools</a></li>
        <li><a href="plugins">Plug-in</a></li>
        <li><a href="articles">Articles</a></li>
        <li><a href="contact" class="active">Contact</a></li>
      </ul>
      <!-- Mobile Theme Toggle -->
      <button class="mobile-theme-toggle" id="mobileThemeToggle" aria-label="Toggle theme">
        <svg class="sun-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.65 0-3 1.35-3 3s1.35 3 3 3 3-1.35 3-3-1.35-3-3-3zm1-4V2h-2v3h2zm0 17v-3h-2v3h2zM5.99 4.58l2.12 2.12 1.41-1.41-2.12-2.12-1.41 1.41zm12.02 12.02l2.12 2.12 1.41-1.41-2.12-2.12-1.41 1.41zM2 13h3v-2H2v2zm17 0h3v-2h-3v2zM5.99 19.42l1.41-1.41-2.12-2.12-1.41 1.41 2.12 2.12zM18.01 7.29l1.41-1.41-2.12-2.12-1.41 1.41 2.12 2.12z"/>
        </svg>
        <svg class="moon-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/>
        </svg>
      </button>
    </div>

    <!-- Side menu -->
    <nav class="side-menu">
      <ul class="menu-list">
        <li class="menu-item">
          <span class="menu-bullet"></span>
          <span class="menu-line"></span>
          <a href="/" class="menu-link">TOP</a>
        </li>
        <li class="menu-item">
          <span class="menu-bullet"></span>
          <span class="menu-line"></span>
          <a href="mixing" class="menu-link">Mixing</a>
        </li>
        <li class="menu-item">
          <span class="menu-bullet"></span>
          <span class="menu-line"></span>
          <a href="3danimation" class="menu-link">3D Animation</a>
        </li>
        <li class="menu-item">
          <span class="menu-bullet"></span>
          <span class="menu-line"></span>
          <a href="music" class="menu-link">Music</a>
        </li>
        <li class="menu-item">
          <span class="menu-bullet"></span>
          <span class="menu-line"></span>
          <a href="planning" class="menu-link">Planning Progress</a>
        </li>
        <li class="menu-item">
          <span class="menu-bullet"></span>
          <span class="menu-line"></span>
          <a href="price" class="menu-link">Price</a>
        </li>
        <li class="menu-item">
          <span class="menu-bullet"></span>
          <span class="menu-line"></span>
          <a href="tools" class="menu-link">Tools</a>
        </li>
        <li class="menu-item">
          <span class="menu-bullet"></span>
          <span class="menu-line"></span>
          <a href="plugins" class="menu-link">Plug-in</a>
        </li>
        <li class="menu-item">
          <span class="menu-bullet"></span>
          <span class="menu-line"></span>
          <a href="articles" class="menu-link">Articles</a>
        </li>
        <li class="menu-item">
          <span class="menu-bullet active"></span>
          <a href="contact" class="menu-link active">Contact</a>
        </li>
      </ul>
      <!-- Social Icons -->
      <div class="social-icons">
        <a href="https://x.com/DOSUKOI_JK" target="_blank" class="social-icon" title="X (Twitter)">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
          </svg>
        </a>
        <a href="https://x.com/okazaki_yuki01" target="_blank" class="social-icon" title="X (Twitter)">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
          </svg>
        </a>
        <a href="https://discord.com/users/528093170484117518" target="_blank" class="social-icon" title="Discord">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"/>
          </svg>
        </a>
        <a href="https://okazakiyuki.booth.pm/" target="_blank" class="social-icon" title="BOOTH">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 2h18a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1zm4 4v12h4c1.5 0 2.7-.4 3.4-1.1.7-.7 1.1-1.6 1.1-2.6 0-.8-.2-1.4-.6-2-.4-.5-.9-.9-1.6-1.1.5-.2 1-.6 1.3-1 .3-.5.5-1 .5-1.7 0-1-.4-1.8-1.1-2.4C13.3 6.4 12.2 6 10.8 6H7zm3 2.5h1.2c.5 0 .9.1 1.2.4.3.2.4.5.4.9s-.1.7-.4.9c-.3.2-.7.4-1.2.4H10V8.5zm0 5h1.5c.6 0 1 .1 1.3.4.3.3.5.6.5 1s-.2.8-.5 1c-.3.3-.8.4-1.3.4H10v-2.8z"/>
          </svg>
        </a>
        <!-- Theme Toggle -->
        <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
          <svg class="sun-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.65 0-3 1.35-3 3s1.35 3 3 3 3-1.35 3-3-1.35-3-3-3zm1-4V2h-2v3h2zm0 17v-3h-2v3h2zM5.99 4.58l2.12 2.12 1.41-1.41-2.12-2.12-1.41 1.41zm12.02 12.02l2.12 2.12 1.41-1.41-2.12-2.12-1.41 1.41zM2 13h3v-2H2v2zm17 0h3v-2h-3v2zM5.99 19.42l1.41-1.41-2.12-2.12-1.41 1.41 2.12 2.12zM18.01 7.29l1.41-1.41-2.12-2.12-1.41 1.41 2.12 2.12z"/>
          </svg>
          <svg class="moon-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/>
          </svg>
        </button>
      </div>
    </nav>

    <!-- Animated gradient background -->
    <div class="gradient-bg"></div>

    <!-- Grid pattern overlay -->
    <div class="grid-pattern"></div>

    <!-- Floating orbs -->
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>

    <!-- Main content -->
    <div class="content">
      <h1 class="page-title">CONTACT</h1>

      <p class="page-description">このフォームはMix依頼専用です。<br>その他のお問い合わせは下記より直接ご連絡ください。</p>

      <div class="direct-contact-container">
        <button type="button" class="direct-contact-btn" onclick="openContactPopup()">
          直接連絡する
        </button>
      </div>

      <!-- Contact Popup -->
      <div class="contact-popup-overlay" id="contactPopupOverlay" onclick="closeContactPopup(event)">
        <div class="contact-popup">
          <button class="contact-popup-close" onclick="closeContactPopup()">&times;</button>
          <h3 class="contact-popup-title">連絡先を選択</h3>
          <p class="contact-popup-recommend">※ Discordでのご連絡を推奨しています</p>
          <div class="contact-popup-icons">
            <a href="https://discord.com/users/528093170484117518" target="_blank" class="contact-popup-link">
              <div class="contact-popup-icon discord">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"/>
                </svg>
              </div>
              <span class="contact-popup-label">Discord</span>
              <span class="contact-popup-badge">推奨</span>
            </a>
            <a href="https://x.com/DOSUKOI_JK" target="_blank" class="contact-popup-link">
              <div class="contact-popup-icon x-twitter">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                </svg>
              </div>
              <span class="contact-popup-label">X (Twitter)</span>
            </a>
          </div>
        </div>
      </div>

      <form id="estimateForm" class="estimate-form">
        <div class="form-group">
          <label for="name">お名前 <span class="required">*</span></label>
          <input type="text" id="name" name="name" required>
        </div>

        <div class="form-group">
          <label for="songName">曲名 <span class="required">*</span></label>
          <input type="text" id="songName" name="songName" required>
        </div>

        <!-- プラン選択（カード形式） -->
        <div class="form-group">
          <label>プラン <span class="required">*</span></label>
          <div class="contact-cards" id="planCards">
            <div class="contact-card-wrapper">
              <div class="contact-card tap-select" data-plan="Short" data-price="2000" onclick="tapPlan(this)">
                <span class="contact-card-name">Short</span>
                <span class="contact-card-price">¥2,000~</span>
              </div>
              <div class="qty-display small" data-for="Short">
                <button type="button" class="qty-btn minus" onclick="changePlanQty('Short', -1, event)">-</button>
                <span class="qty-value">0</span>
                <button type="button" class="qty-btn plus" onclick="changePlanQty('Short', 1, event)">+</button>
              </div>
            </div>
            <div class="contact-card-wrapper">
              <div class="contact-card tap-select" data-plan="One Chorus" data-price="3000" onclick="tapPlan(this)">
                <span class="contact-card-name">One Chorus</span>
                <span class="contact-card-price">¥3,000~</span>
              </div>
              <div class="qty-display small" data-for="One Chorus">
                <button type="button" class="qty-btn minus" onclick="changePlanQty('One Chorus', -1, event)">-</button>
                <span class="qty-value">0</span>
                <button type="button" class="qty-btn plus" onclick="changePlanQty('One Chorus', 1, event)">+</button>
              </div>
            </div>
            <div class="contact-card-wrapper">
              <div class="contact-card tap-select" data-plan="Full Chorus" data-price="6000" onclick="tapPlan(this)">
                <span class="contact-card-name">Full Chorus</span>
                <span class="contact-card-price">¥6,000~</span>
              </div>
              <div class="qty-display small" data-for="Full Chorus">
                <button type="button" class="qty-btn minus" onclick="changePlanQty('Full Chorus', -1, event)">-</button>
                <span class="qty-value">0</span>
                <button type="button" class="qty-btn plus" onclick="changePlanQty('Full Chorus', 1, event)">+</button>
              </div>
            </div>
          </div>
        </div>

        <!-- 納期オプション -->
        <div class="form-group">
          <label>納期オプション</label>
          <p class="form-note" style="margin-bottom: 15px;">One Chorus / Full Chorus</p>
          <div class="contact-cards four-cols" id="deliveryStandardCards">
            <div class="contact-card-wrapper">
              <div class="contact-card tap-select" data-delivery="standard-2週間" data-price="0" onclick="tapDelivery(this)">
                <span class="contact-card-name">2週間</span>
                <span class="contact-card-price">¥0</span>
              </div>
              <div class="qty-display small" data-for="standard-2週間">
                <button type="button" class="qty-btn minus" onclick="changeDeliveryQty('standard-2週間', -1, event)">-</button>
                <span class="qty-value">0</span>
                <button type="button" class="qty-btn plus" onclick="changeDeliveryQty('standard-2週間', 1, event)">+</button>
              </div>
            </div>
            <div class="contact-card-wrapper">
              <div class="contact-card tap-select" data-delivery="standard-1週間" data-price="1500" onclick="tapDelivery(this)">
                <span class="contact-card-name">1週間</span>
                <span class="contact-card-price">+¥1,500</span>
              </div>
              <div class="qty-display small" data-for="standard-1週間">
                <button type="button" class="qty-btn minus" onclick="changeDeliveryQty('standard-1週間', -1, event)">-</button>
                <span class="qty-value">0</span>
                <button type="button" class="qty-btn plus" onclick="changeDeliveryQty('standard-1週間', 1, event)">+</button>
              </div>
            </div>
            <div class="contact-card-wrapper">
              <div class="contact-card tap-select" data-delivery="standard-3日" data-price="4000" onclick="tapDelivery(this)">
                <span class="contact-card-name">3日</span>
                <span class="contact-card-price">+¥4,000</span>
              </div>
              <div class="qty-display small" data-for="standard-3日">
                <button type="button" class="qty-btn minus" onclick="changeDeliveryQty('standard-3日', -1, event)">-</button>
                <span class="qty-value">0</span>
                <button type="button" class="qty-btn plus" onclick="changeDeliveryQty('standard-3日', 1, event)">+</button>
              </div>
            </div>
            <div class="contact-card-wrapper">
              <div class="contact-card tap-select" data-delivery="standard-24時間以内" data-price="6000" onclick="tapDelivery(this)">
                <span class="contact-card-name">24時間以内</span>
                <span class="contact-card-price">+¥6,000</span>
              </div>
              <div class="qty-display small" data-for="standard-24時間以内">
                <button type="button" class="qty-btn minus" onclick="changeDeliveryQty('standard-24時間以内', -1, event)">-</button>
                <span class="qty-value">0</span>
                <button type="button" class="qty-btn plus" onclick="changeDeliveryQty('standard-24時間以内', 1, event)">+</button>
              </div>
            </div>
          </div>
          <p class="form-note" style="margin-top: 20px; margin-bottom: 15px;">Short</p>
          <div class="contact-cards" id="deliveryShortCards">
            <div class="contact-card-wrapper">
              <div class="contact-card tap-select" data-delivery="short-3日" data-price="0" onclick="tapDelivery(this)">
                <span class="contact-card-name">3日</span>
                <span class="contact-card-price">¥0</span>
              </div>
              <div class="qty-display small" data-for="short-3日">
                <button type="button" class="qty-btn minus" onclick="changeDeliveryQty('short-3日', -1, event)">-</button>
                <span class="qty-value">0</span>
                <button type="button" class="qty-btn plus" onclick="changeDeliveryQty('short-3日', 1, event)">+</button>
              </div>
            </div>
            <div class="contact-card-wrapper">
              <div class="contact-card tap-select" data-delivery="short-24時間以内" data-price="1000" onclick="tapDelivery(this)">
                <span class="contact-card-name">24時間以内</span>
                <span class="contact-card-price">+¥1,000</span>
              </div>
              <div class="qty-display small" data-for="short-24時間以内">
                <button type="button" class="qty-btn minus" onclick="changeDeliveryQty('short-24時間以内', -1, event)">-</button>
                <span class="qty-value">0</span>
                <button type="button" class="qty-btn plus" onclick="changeDeliveryQty('short-24時間以内', 1, event)">+</button>
              </div>
            </div>
          </div>
        </div>

        <!-- その他オプション -->
        <div class="form-group">
          <label>その他オプション</label>
          <div class="contact-cards" id="otherOptionCards">
            <div class="contact-card-wrapper">
              <div class="contact-card tap-select" data-option="カットアップ" data-price="2000" data-variable="true" onclick="tapOption(this)">
                <span class="contact-card-name">カットアップ</span>
                <span class="contact-card-price">¥2,000~</span>
              </div>
              <div class="qty-display small" data-for="カットアップ">
                <button type="button" class="qty-btn minus" onclick="changeOptionQty('カットアップ', -1, event)">-</button>
                <span class="qty-value">0</span>
                <button type="button" class="qty-btn plus" onclick="changeOptionQty('カットアップ', 1, event)">+</button>
              </div>
            </div>
            <div class="contact-card-wrapper">
              <div class="contact-card tap-select" data-option="エンコード" data-price="1000" onclick="tapOption(this)">
                <span class="contact-card-name">エンコード</span>
                <span class="contact-card-price">¥1,000</span>
              </div>
              <div class="qty-display small" data-for="エンコード">
                <button type="button" class="qty-btn minus" onclick="changeOptionQty('エンコード', -1, event)">-</button>
                <span class="qty-value">0</span>
                <button type="button" class="qty-btn plus" onclick="changeOptionQty('エンコード', 1, event)">+</button>
              </div>
            </div>
            <div class="contact-card-wrapper">
              <div class="contact-card tap-select" data-option="ハモリガイドメロ作成" data-price="3000" data-variable="true" onclick="tapOption(this)">
                <span class="contact-card-name">ハモリガイドメロ作成</span>
                <span class="contact-card-price">¥3,000~</span>
              </div>
              <div class="qty-display small" data-for="ハモリガイドメロ作成">
                <button type="button" class="qty-btn minus" onclick="changeOptionQty('ハモリガイドメロ作成', -1, event)">-</button>
                <span class="qty-value">0</span>
                <button type="button" class="qty-btn plus" onclick="changeOptionQty('ハモリガイドメロ作成', 1, event)">+</button>
              </div>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="remarks">備考・要望</label>
          <textarea id="remarks" name="remarks" rows="4"></textarea>
        </div>

        <div class="form-group">
          <label for="fileUrl">音源ファイルURL <span class="required">*</span></label>
          <input type="url" id="fileUrl" name="fileUrl" placeholder="https://gigafile.nu/XXXX" required>
          <p class="file-note">※ <a href="https://gigafile.nu/" target="_blank" style="color: var(--accent-primary);">ギガファイル便</a>にアップロードしてURLを貼り付けてください</p>
          <p class="file-note">※ 複数曲ご依頼の場合は、曲ごとにフォルダ分けをお願いします</p>
          <p class="file-note" style="margin-left: 1em;">- フォルダ名：曲名＋尺（例：曲名_Short）</p>
          <p class="file-note" style="margin-left: 1em;">- zipファイル名：活動者名</p>
          <p class="file-note" style="margin-left: 1em;">- 1つのzipファイルにまとめてください</p>
        </div>

        <!-- 見積金額表示 -->
        <div class="estimate-total">
          <span class="estimate-label">概算見積り金額</span>
          <span class="estimate-amount" id="estimateAmount">¥0~</span>
        </div>
        <p class="estimate-note">※ トラック数や作業の工数によって金額が上下する場合があります</p>

        <button type="submit" class="submit-btn" id="submitBtn">送信する</button>
        <div id="uploadProgress" class="upload-progress" style="display: none;">
          <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
          <p class="progress-text" id="progressText">アップロード中...</p>
        </div>
      </form>

      <div id="formMessage" class="form-message"></div>

      <!-- Submit Success Popup -->
      <div class="contact-popup-overlay" id="submitSuccessPopup" onclick="closeSubmitSuccessPopup(event)">
        <div class="contact-popup">
          <button class="contact-popup-close" onclick="closeSubmitSuccessPopup()">&times;</button>
          <h3 class="contact-popup-title">送信完了</h3>
          <p class="contact-popup-message">ご依頼ありがとうございます！<br>お手数ですが、XまたはDiscordのDMにて<br>依頼を送信した旨をご連絡ください。</p>
          <div class="contact-popup-icons">
            <a href="https://discord.com/users/528093170484117518" target="_blank" class="contact-popup-link">
              <div class="contact-popup-icon discord">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"/>
                </svg>
              </div>
              <span class="contact-popup-label">Discord</span>
              <span class="contact-popup-badge">推奨</span>
            </a>
            <a href="https://x.com/DOSUKOI_JK" target="_blank" class="contact-popup-link">
              <div class="contact-popup-icon x-twitter">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                </svg>
              </div>
              <span class="contact-popup-label">X (Twitter)</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const GAS_URL = 'https://script.google.com/macros/s/AKfycbzRJgSS8wavzPcFXkktF9WwnAkL2XBKpUHqHyOKVMRwWqNA3w12-fOPHkvy5Oeo9wJPPg/exec';

    // 数量データを保持
    const quantities = {
      plans: {},
      delivery: {},
      options: {}
    };

    // プランカードをタップ
    function tapPlan(card) {
      const plan = card.getAttribute('data-plan');
      quantities.plans[plan] = (quantities.plans[plan] || 0) + 1;
      updateDisplay(plan, quantities.plans[plan], '.contact-card');
      calculateEstimate();
    }

    // プラン数量変更
    function changePlanQty(plan, delta, event) {
      event.stopPropagation();
      quantities.plans[plan] = Math.max(0, (quantities.plans[plan] || 0) + delta);
      updateDisplay(plan, quantities.plans[plan], '.contact-card');
      calculateEstimate();
    }

    // 納期カードをタップ
    function tapDelivery(card) {
      const delivery = card.getAttribute('data-delivery');
      quantities.delivery[delivery] = (quantities.delivery[delivery] || 0) + 1;
      updateDisplay(delivery, quantities.delivery[delivery], '.contact-card');
      calculateEstimate();
    }

    // 納期数量変更
    function changeDeliveryQty(delivery, delta, event) {
      event.stopPropagation();
      quantities.delivery[delivery] = Math.max(0, (quantities.delivery[delivery] || 0) + delta);
      updateDisplay(delivery, quantities.delivery[delivery], '.contact-card');
      calculateEstimate();
    }

    // オプションカードをタップ
    function tapOption(card) {
      const option = card.getAttribute('data-option');
      quantities.options[option] = (quantities.options[option] || 0) + 1;
      updateDisplay(option, quantities.options[option], '.contact-card');
      calculateEstimate();
    }

    // オプション数量変更
    function changeOptionQty(option, delta, event) {
      event.stopPropagation();
      quantities.options[option] = Math.max(0, (quantities.options[option] || 0) + delta);
      updateDisplay(option, quantities.options[option], '.contact-card');
      calculateEstimate();
    }

    // 表示を更新
    function updateDisplay(key, value, cardSelector) {
      const display = document.querySelector(`.qty-display[data-for="${key}"] .qty-value`);
      if (display) {
        display.textContent = value;
      }
      // カードのselected状態を更新
      const card = document.querySelector(`${cardSelector}[data-plan="${key}"], ${cardSelector}[data-delivery="${key}"], ${cardSelector}[data-option="${key}"]`);
      if (card) {
        if (value > 0) {
          card.classList.add('selected');
        } else {
          card.classList.remove('selected');
        }
      }
    }

    // 見積金額計算
    function calculateEstimate() {
      let total = 0;
      let hasVariable = false;

      // プラン料金
      const planPrices = { 'Short': 2000, 'One Chorus': 3000, 'Full Chorus': 6000 };
      for (const [plan, qty] of Object.entries(quantities.plans)) {
        if (qty > 0) {
          total += (planPrices[plan] || 0) * qty;
        }
      }

      // 納期オプション料金
      for (const [delivery, qty] of Object.entries(quantities.delivery)) {
        if (qty > 0) {
          const card = document.querySelector(`.contact-card[data-delivery="${delivery}"]`);
          if (card) {
            const price = parseInt(card.getAttribute('data-price')) || 0;
            total += price * qty;
          }
        }
      }

      // その他オプション料金
      for (const [option, qty] of Object.entries(quantities.options)) {
        if (qty > 0) {
          const card = document.querySelector(`.contact-card[data-option="${option}"]`);
          if (card) {
            const price = parseInt(card.getAttribute('data-price')) || 0;
            const isVariable = card.getAttribute('data-variable') === 'true';
            total += price * qty;
            if (isVariable) {
              hasVariable = true;
            }
          }
        }
      }

      // 表示更新
      const display = document.getElementById('estimateAmount');
      if (total > 0) {
        display.textContent = '¥' + total.toLocaleString() + (hasVariable ? '~' : '');
      } else {
        display.textContent = '¥0~';
      }
    }

    // URLパラメータから選択状態を復元
    function restoreFromUrlParams() {
      var search = window.location.search;
      if (!search) {
        return;
      }

      var urlParams = new URLSearchParams(search);
      var planValue = urlParams.get('plan');
      var deliveryValue = urlParams.get('delivery');
      var optionsValue = urlParams.get('options');

      // 数量付きフォーマットをパース（例: "Short x2, One Chorus x1"）
      if (planValue) {
        var planItems = planValue.split(',');
        for (var i = 0; i < planItems.length; i++) {
          var item = planItems[i].trim();
          var match = item.match(/^(.+)\s+x(\d+)$/);
          if (match) {
            var name = match[1].trim();
            var qty = parseInt(match[2]);
            quantities.plans[name] = qty;
            updateDisplay(name, qty, '.contact-card');
          } else if (item) {
            // 旧フォーマット（数量なし）
            quantities.plans[item] = 1;
            updateDisplay(item, 1, '.contact-card');
          }
        }
      }

      if (deliveryValue) {
        var deliveryItems = deliveryValue.split(',');
        for (var i = 0; i < deliveryItems.length; i++) {
          var item = deliveryItems[i].trim();
          var match = item.match(/^(.+)\s+x(\d+)$/);
          if (match) {
            var name = match[1].trim();
            var qty = parseInt(match[2]);
            // standard-XXX または short-XXX の形式で保存
            // URLからは "2週間 x1" のような形式なので、適切なキーを探す
            var deliveryCards = document.querySelectorAll('.contact-card[data-delivery]');
            for (var j = 0; j < deliveryCards.length; j++) {
              var cardDelivery = deliveryCards[j].getAttribute('data-delivery');
              if (cardDelivery.endsWith(name)) {
                quantities.delivery[cardDelivery] = qty;
                updateDisplay(cardDelivery, qty, '.contact-card');
                break;
              }
            }
          }
        }
      }

      if (optionsValue) {
        var optionItems = optionsValue.split(',');
        for (var i = 0; i < optionItems.length; i++) {
          var item = optionItems[i].trim();
          var match = item.match(/^(.+)\s+x(\d+)$/);
          if (match) {
            var name = match[1].trim();
            var qty = parseInt(match[2]);
            quantities.options[name] = qty;
            updateDisplay(name, qty, '.contact-card');
          } else if (item) {
            quantities.options[item] = 1;
            updateDisplay(item, 1, '.contact-card');
          }
        }
      }

      calculateEstimate();
    }

    // ページ読み込み完了後に実行
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', restoreFromUrlParams);
    } else {
      restoreFromUrlParams();
    }

    // 選択データを文字列に変換
    function getSelectedPlans() {
      var plans = [];
      for (var plan in quantities.plans) {
        if (quantities.plans[plan] > 0) {
          plans.push(plan + ' x' + quantities.plans[plan]);
        }
      }
      return plans.join(', ');
    }

    function getSelectedDeliveries() {
      var deliveries = [];
      for (var delivery in quantities.delivery) {
        if (quantities.delivery[delivery] > 0) {
          var name = delivery.split('-').slice(1).join('-');
          deliveries.push(name + ' x' + quantities.delivery[delivery]);
        }
      }
      return deliveries.join(', ');
    }

    function getSelectedOptions() {
      var options = [];
      for (var option in quantities.options) {
        if (quantities.options[option] > 0) {
          options.push(option + ' x' + quantities.options[option]);
        }
      }
      return options.join(', ');
    }

    // フォーム送信
    document.getElementById('estimateForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      // プランが選択されているかチェック
      var selectedPlans = getSelectedPlans();
      if (!selectedPlans) {
        alert('プランを選択してください');
        return;
      }

      var submitBtn = document.getElementById('submitBtn');
      var uploadProgress = document.getElementById('uploadProgress');
      var progressFill = document.getElementById('progressFill');
      var progressText = document.getElementById('progressText');
      var formMessage = document.getElementById('formMessage');

      // UI更新
      submitBtn.disabled = true;
      submitBtn.textContent = '送信中...';
      uploadProgress.style.display = 'block';
      formMessage.style.display = 'none';
      progressFill.style.width = '30%';
      progressText.textContent = '送信中...';

      try {
        // フォームデータ取得
        var formData = new FormData(this);

        progressFill.style.width = '50%';

        // GASに送信
        var response = await fetch(GAS_URL, {
          method: 'POST',
          mode: 'no-cors',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            formInfo: {
              name: formData.get('name'),
              songName: formData.get('songName'),
              plan: selectedPlans,
              deliveryOption: getSelectedDeliveries(),
              otherOptions: getSelectedOptions(),
              fileUrl: formData.get('fileUrl') || '',
              remarks: formData.get('remarks') || ''
            }
          })
        });

        progressFill.style.width = '100%';
        progressText.textContent = '完了！';

        // フォームリセット
        document.getElementById('estimateForm').reset();
        // 数量もリセット
        quantities.plans = {};
        quantities.delivery = {};
        quantities.options = {};
        document.querySelectorAll('.qty-value').forEach(function(el) { el.textContent = '0'; });
        document.querySelectorAll('.contact-card.selected').forEach(function(el) { el.classList.remove('selected'); });
        calculateEstimate();

        // 進捗バーを非表示
        setTimeout(function() {
          uploadProgress.style.display = 'none';
          progressFill.style.width = '0%';
        }, 1000);

        // 送信完了ポップアップを表示
        setTimeout(function() {
          openSubmitSuccessPopup();
        }, 500);

      } catch (error) {
        console.error('送信エラー:', error);
        formMessage.className = 'form-message error';
        formMessage.textContent = '送信に失敗しました。もう一度お試しください。';
        formMessage.style.display = 'block';
        uploadProgress.style.display = 'none';
      }

      // ボタンを戻す
      submitBtn.disabled = false;
      submitBtn.textContent = '送信する';
    });

    // Mobile menu toggle
    function toggleMobileMenu() {
      const hamburger = document.querySelector('.hamburger-menu');
      const overlay = document.getElementById('mobileMenuOverlay');
      hamburger.classList.toggle('active');
      overlay.classList.toggle('active');
    }

    // Contact popup functions
    function openContactPopup() {
      document.getElementById('contactPopupOverlay').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeContactPopup(event) {
      // If event exists and click was on the popup content, don't close
      if (event && event.target !== event.currentTarget) return;
      document.getElementById('contactPopupOverlay').classList.remove('active');
      document.body.style.overflow = '';
    }

    // Submit success popup functions
    function openSubmitSuccessPopup() {
      document.getElementById('submitSuccessPopup').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeSubmitSuccessPopup(event) {
      if (event && event.target !== event.currentTarget) return;
      document.getElementById('submitSuccessPopup').classList.remove('active');
      document.body.style.overflow = '';
    }

    // Close popup with Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeContactPopup();
        closeSubmitSuccessPopup();
      }
    });
  </script>
</body>
</html>
