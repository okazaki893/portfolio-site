<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Portfolioç®¡ç†</title>
  <link rel="icon" type="image/png" href="images/favicon.png">
  <!-- OGP -->
  <meta property="og:title" content="Admin - Noumenon">
  <meta property="og:description" content="Portfolioç®¡ç†">
  <meta property="og:image" content="https://noumenon.jp/OGP.png">
  <meta property="og:url" content="https://noumenon.jp/admin">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Admin - Noumenon">
  <meta name="twitter:description" content="Portfolioç®¡ç†">
  <meta name="twitter:image" content="https://noumenon.jp/OGP.png">
  <link rel="stylesheet" href="css/theme.css">
  <link rel="stylesheet" href="css/price.css">
  <style>
    /* Adminç”¨ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒ */
    :root {
      --accent-primary: #fff !important;
      --accent-secondary: #ccc !important;
      --accent-glow: rgba(255, 255, 255, 0.3) !important;
      --accent-muted: rgba(255, 255, 255, 0.2) !important;
      --accent-dim: rgba(255, 255, 255, 0.1) !important;
      --border-color: rgba(255, 255, 255, 0.2) !important;
      --border-hover: rgba(255, 255, 255, 0.4) !important;
      --border-active: #fff !important;
      --bg-primary: #101016 !important;
      --bg-secondary: #1a1a22 !important;
      --bg-card: #101016 !important;
      --popup-bg: #101016 !important;
      --input-bg: #1a1a22 !important;
      --text-primary: #fff !important;
      --text-secondary: #ccc !important;
      --text-dim: #999 !important;
    }

    body {
      background: #101016 !important;
    }

    .admin-container {
      background: #101016 !important;
    }

    .login-form,
    .video-item,
    .plugin-item,
    .add-form,
    .edit-form {
      background: #1a1a22 !important;
    }

    .edit-popup-content {
      background: #101016 !important;
    }

    input, textarea, select {
      background: #1a1a22 !important;
      color: #fff !important;
      border-color: rgba(255, 255, 255, 0.2) !important;
    }

    input::placeholder, textarea::placeholder {
      color: #666 !important;
    }

    /* ãƒœã‚¿ãƒ³ï¼ˆèƒŒæ™¯ã‚ã‚Šï¼‰: èƒŒæ™¯ç™½ã€æ–‡å­—é»’ */
    .login-form button,
    .add-form button,
    .btn-edit,
    .btn-save,
    .btn-delete,
    .btn-cancel,
    .modal-buttons button,
    .logout-btn,
    button[onclick] {
      background: #fff !important;
      color: #000 !important;
    }

    .login-form button:hover,
    .add-form button:hover,
    .btn-edit:hover,
    .btn-save:hover,
    .btn-delete:hover,
    .logout-btn:hover {
      background: #ccc !important;
    }

    /* ã‚¿ãƒ–ãƒœã‚¿ãƒ³: èƒŒæ™¯ç™½ã€æ–‡å­—é»’ */
    .tab-button {
      color: #000 !important;
      background: #fff !important;
    }

    .tab-button.active {
      color: #000 !important;
      background: #ccc !important;
      border-bottom-color: #fff !important;
    }

    .tab-button:hover {
      color: #000 !important;
      background: #ccc !important;
    }

    /* èƒŒæ™¯ãªã—ã®ãƒ†ã‚­ã‚¹ãƒˆ: ç™½ */
    .admin-title,
    .section-title,
    .video-info h4,
    .video-info p,
    h3, h4, label {
      color: #fff !important;
    }

    /* ãƒªãƒ³ã‚¯: ç™½ */
    a:not(.btn-edit):not(.btn-delete) {
      color: #fff !important;
    }

    /* SVGã‚¢ã‚¤ã‚³ãƒ³: ç™½ */
    svg:not(button svg) {
      fill: #fff !important;
    }

    /* ãƒœã‚¿ãƒ³å†…ã®SVG: é»’ */
    button svg {
      fill: #000 !important;
    }

    .admin-container {
      position: relative;
      z-index: 10;
      width: 100%;
      min-height: 100vh;
      padding: 40px 60px 60px 340px;
    }

    .admin-title {
      font-family: 'Times New Roman', Times, serif;
      font-size: 48px;
      font-weight: bold;
      color: var(--accent-primary, #ffffff);
      letter-spacing: 10px;
      margin-bottom: 40px;
      text-shadow: 0 0 40px var(--accent-glow, rgba(255, 255, 255, 0.5));
    }

    /* Login Form */
    .login-container {
      position: relative;
      z-index: 10;
      width: 100%;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .login-form {
      background: var(--bg-card, rgba(20, 20, 25, 0.9));
      border: 1px solid var(--border-color, rgba(255, 255, 255, 0.2));
      border-radius: 16px;
      padding: 40px;
      width: 100%;
      max-width: 400px;
    }

    .login-form h2 {
      font-family: 'Times New Roman', Times, serif;
      font-size: 32px;
      color: var(--accent-primary, #ffffff);
      text-align: center;
      margin-bottom: 30px;
    }

    .login-form input {
      width: 100%;
      padding: 15px;
      background: var(--input-bg, rgba(26, 26, 34, 0.8));
      border: 1px solid var(--border-color, rgba(255, 255, 255, 0.2));
      border-radius: 8px;
      color: var(--text-primary, #fff);
      font-size: 16px;
      margin-bottom: 20px;
    }

    .login-form button {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, var(--accent-primary, #ffffff) 0%, var(--accent-secondary, #cccccc) 100%);
      border: none;
      border-radius: 8px;
      color: var(--text-primary, #fff);
      font-size: 16px;
      cursor: pointer;
      transition: box-shadow 0.3s ease;
    }

    .login-form button:hover {
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.3);
    }

    .login-error {
      color: #ff6b6b;
      text-align: center;
      margin-top: 15px;
      font-size: 14px;
    }

    /* Admin Panel */
    .admin-panel {
      display: none;
    }

    .admin-section {
      background: var(--bg-card, rgba(20, 20, 25, 0.8));
      border: 1px solid var(--border-color, rgba(255, 255, 255, 0.15));
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
    }

    .admin-section h3 {
      font-family: 'Arial', sans-serif;
      font-size: 20px;
      color: var(--accent-primary, #ffffff);
      margin-bottom: 20px;
      letter-spacing: 2px;
    }

    .video-list {
      max-height: 400px;
      overflow-y: auto;
    }

    .video-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      background: var(--input-bg, rgba(26, 26, 34, 0.5));
      border: 1px solid var(--border-color, rgba(255, 255, 255, 0.1));
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .video-number {
      display: flex;
      align-items: center;
      gap: 5px;
      min-width: 70px;
    }

    .video-number input {
      width: 45px;
      padding: 8px;
      background: var(--input-bg, rgba(26, 26, 34, 0.8));
      border: 1px solid var(--border-color, rgba(255, 255, 255, 0.2));
      border-radius: 4px;
      color: var(--text-primary, #fff);
      font-size: 14px;
      text-align: center;
    }

    .video-number input:focus {
      outline: none;
      border-color: #fff;
    }

    .video-item img {
      width: 120px;
      height: 68px;
      object-fit: cover;
      border-radius: 4px;
    }

    .video-info {
      flex: 1;
    }

    .video-info h4 {
      color: var(--text-primary, #fff);
      font-size: 14px;
      margin-bottom: 5px;
    }

    .video-info p {
      color: var(--text-dim, rgba(255, 255, 255, 0.5));
      font-size: 12px;
    }

    .video-actions {
      display: flex;
      gap: 10px;
    }

    .btn-edit, .btn-delete {
      padding: 8px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      transition: opacity 0.3s ease;
    }

    .btn-edit {
      background: var(--accent-primary, #ffffff);
      color: var(--text-primary, #fff);
    }

    .btn-delete {
      background: #ffffff;
      color: var(--text-primary, #fff);
    }

    .btn-edit:hover, .btn-delete:hover {
      opacity: 0.8;
    }

    /* Add Form */
    .add-form {
      display: grid;
      gap: 15px;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.15);
    }

    .add-form input {
      padding: 12px 15px;
      background: var(--input-bg, rgba(26, 26, 34, 0.8));
      border: 1px solid var(--border-color, rgba(255, 255, 255, 0.2));
      border-radius: 8px;
      color: var(--text-primary, #fff);
      font-size: 14px;
    }

    .add-form button {
      padding: 12px 20px;
      background: linear-gradient(135deg, var(--accent-primary, #ffffff) 0%, var(--accent-secondary, #cccccc) 100%);
      border: none;
      border-radius: 8px;
      color: var(--text-primary, #fff);
      font-size: 14px;
      cursor: pointer;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }

    /* Logout Button */
    .logout-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 10px 20px;
      background: rgba(255, 107, 107, 0.9);
      border: none;
      border-radius: 8px;
      color: var(--text-primary, #fff);
      font-size: 14px;
      cursor: pointer;
      z-index: 100;
    }

    .logout-btn:hover {
      background: rgba(255, 80, 80, 1);
    }

    /* Save Status */
    .save-status {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 15px 25px;
      background: rgba(107, 255, 107, 0.9);
      border-radius: 8px;
      color: #fff;
      font-size: 14px;
      display: none;
      z-index: 100;
    }

    /* Edit Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 200;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: var(--popup-bg, rgba(16, 16, 22, 0.98));
      border: 1px solid var(--border-color, rgba(255, 255, 255, 0.2));
      border-radius: 16px;
      padding: 30px;
      width: 100%;
      max-width: 500px;
    }

    .modal-content h3 {
      color: var(--accent-primary, #ffffff);
      margin-bottom: 20px;
    }

    .modal-content input {
      width: 100%;
      padding: 12px 15px;
      background: var(--input-bg, rgba(26, 26, 34, 0.8));
      border: 1px solid var(--border-color, rgba(255, 255, 255, 0.2));
      border-radius: 8px;
      color: var(--text-primary, #fff);
      font-size: 14px;
      margin-bottom: 15px;
    }

    .modal-buttons {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }

    .modal-buttons button {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .btn-save {
      background: var(--accent-primary, #ffffff);
      color: var(--text-primary, #fff);
    }

    .btn-cancel {
      background: var(--text-faint, rgba(255, 255, 255, 0.2));
      color: var(--text-primary, #fff);
    }

    /* Tab Navigation */
    .tab-navigation {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      padding-bottom: 0;
    }

    .tab-button {
      padding: 15px 30px;
      background: transparent;
      border: none;
      border-bottom: 3px solid transparent;
      color: var(--text-dim, rgba(255, 255, 255, 0.5));
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      letter-spacing: 1px;
    }

    .tab-button:hover {
      color: var(--text-secondary, rgba(255, 255, 255, 0.8));
    }

    .tab-button.active {
      color: var(--accent-primary, #ffffff);
      border-bottom-color: var(--accent-primary, #ffffff);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    @media (max-width: 900px) {
      .admin-container {
        padding: 20px;
      }

      .admin-title {
        font-size: 32px;
      }

      .video-item {
        flex-direction: column;
        align-items: flex-start;
      }

      .form-row {
        grid-template-columns: 1fr;
      }

      .tab-navigation {
        flex-wrap: wrap;
      }

      .tab-button {
        padding: 10px 15px;
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="price-page">
    <!-- Animated gradient background -->
    <div class="gradient-bg"></div>
    <div class="grid-pattern"></div>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>

    <!-- Login Form -->
    <div class="login-container" id="loginContainer">
      <div class="login-form">
        <h2>ADMIN LOGIN</h2>
        <input type="password" id="passwordInput" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
        <button onclick="login()">ãƒ­ã‚°ã‚¤ãƒ³</button>
        <p class="login-error" id="loginError"></p>
      </div>
    </div>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
      <button class="logout-btn" onclick="logout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>

      <div class="admin-container">
        <h1 class="admin-title">ADMIN</h1>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
          <button class="tab-button active" onclick="switchTab('top')">Top</button>
          <button class="tab-button" onclick="switchTab('mixing')">Mixing</button>
          <button class="tab-button" onclick="switchTab('3d')">3D Animation</button>
          <button class="tab-button" onclick="switchTab('music')">Music</button>
          <button class="tab-button" onclick="switchTab('planning')">Planning</button>
          <button class="tab-button" onclick="switchTab('plugins')">Plugins</button>
        </div>

        <!-- TOP Tab Content -->
        <div class="tab-content active" id="tab-top">
          <div class="admin-section">
            <h3>TOPãƒšãƒ¼ã‚¸ ãƒ¢ã‚¶ã‚¤ã‚¯å‹•ç”»ç®¡ç†</h3>
            <p style="color: #ccc; margin-bottom: 20px; font-size: 14px;">å„ã‚¹ãƒ­ãƒƒãƒˆã®å‹•ç”»ãƒªãƒ³ã‚¯ã¨ã‚µãƒ ãƒã‚¤ãƒ«ã‚’ç·¨é›†ã§ãã¾ã™ï¼ˆé…ç½®ä½ç½®ã¯å›ºå®šï¼‰</p>
            <div class="video-list" id="topVideoList" style="max-height: 600px;"></div>
          </div>

        </div>

        <!-- Mixing Tab Content -->
        <div class="tab-content" id="tab-mixing">
          <div class="admin-section">
            <h3>Mixing Portfolio å‹•ç”»ç®¡ç†</h3>
            <div class="video-list" id="mixingVideoList"></div>

            <div class="add-form">
              <h4 style="color: #fff; margin-bottom: 10px;">æ–°è¦è¿½åŠ </h4>
              <input type="text" id="newTitle" placeholder="ã‚¿ã‚¤ãƒˆãƒ«">
              <input type="text" id="newYoutubeUrl" placeholder="YouTubeã®URLï¼ˆä¾‹: https://www.youtube.com/watch?v=xxxxxï¼‰">
              <input type="text" id="newThumbnail" placeholder="ã‚«ã‚¹ã‚¿ãƒ ã‚µãƒ ãƒã‚¤ãƒ«ï¼ˆä»»æ„ï¼‰">
              <button onclick="addVideo()">è¿½åŠ </button>
            </div>
          </div>

        </div>

        <!-- 3D Animation Tab Content -->
        <div class="tab-content" id="tab-3d">
          <div class="admin-section">
            <h3>3D Animation Portfolio å‹•ç”»ç®¡ç†</h3>
            <div class="video-list" id="animation3dList"></div>

            <div class="add-form">
              <h4 style="color: #fff; margin-bottom: 10px;">æ–°è¦è¿½åŠ </h4>
              <input type="text" id="new3dTitle" placeholder="ã‚¿ã‚¤ãƒˆãƒ«">
              <input type="text" id="new3dYoutubeUrl" placeholder="YouTubeã®URLï¼ˆä¾‹: https://www.youtube.com/watch?v=xxxxxï¼‰">
              <button onclick="add3dVideo()">è¿½åŠ </button>
            </div>
          </div>

        </div>

        <!-- Music Tab Content -->
        <div class="tab-content" id="tab-music">
          <div class="admin-section">
            <h3>Music Portfolio éŸ³æºç®¡ç†</h3>
            <div class="video-list" id="musicList"></div>

            <div class="add-form">
              <h4 style="color: #fff; margin-bottom: 10px;">æ–°è¦è¿½åŠ </h4>
              <input type="text" id="newMusicTitle" placeholder="æ›²å">
              <input type="text" id="newSoundcloudUrl" placeholder="SoundCloudã®URLï¼ˆä¾‹: https://soundcloud.com/artist/trackï¼‰">
              <button onclick="addMusic()">è¿½åŠ </button>
            </div>
          </div>

        </div>

        <!-- Planning Tab Content -->
        <div class="tab-content" id="tab-planning">
          <div class="admin-section">
            <h3>Planning Progress ä½œå“ç®¡ç†</h3>
            <div class="video-list" id="planningList"></div>

            <div class="add-form">
              <h4 style="color: #fff; margin-bottom: 10px;">æ–°è¦è¿½åŠ </h4>
              <input type="text" id="newPlanningTitle" placeholder="ä½œå“ã‚¿ã‚¤ãƒˆãƒ«">
              <input type="text" id="newPlanningYoutubeUrl" placeholder="YouTubeã®URLï¼ˆä¾‹: https://www.youtube.com/watch?v=xxxxxï¼‰">
              <button onclick="addPlanning()">è¿½åŠ </button>
            </div>
          </div>

        </div>

        <!-- Plugins Tab Content -->
        <div class="tab-content" id="tab-plugins">
          <div class="admin-section">
            <h3>ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç®¡ç†</h3>
            <p style="color: #ccc; margin-bottom: 20px; font-size: 14px;">Otherãƒšãƒ¼ã‚¸ã®Plug-inã‚¿ãƒ–ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ç®¡ç†ã—ã¾ã™</p>
            <div class="video-list" id="pluginsList"></div>

            <div class="add-form">
              <h4 style="color: #fff; margin-bottom: 10px;">æ–°è¦è¿½åŠ </h4>
              <input type="text" id="newPluginTitle" placeholder="ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å">
              <input type="text" id="newPluginDescription" placeholder="èª¬æ˜">
              <input type="text" id="newPluginLink" placeholder="ãƒªãƒ³ã‚¯URLï¼ˆä¾‹: https://example.com/pluginï¼‰">
              <input type="text" id="newPluginTag" placeholder="ã‚«ãƒ†ã‚´ãƒªã‚¿ã‚°ï¼ˆä¾‹: Audio, Video, Utilityï¼‰">
              <button onclick="addPlugin()">è¿½åŠ </button>
            </div>
          </div>

        </div>

      </div>
    </div>

    <!-- Edit TOP Modal -->
    <div class="modal" id="editTopModal">
      <div class="modal-content">
        <h3>TOPã‚¹ãƒ­ãƒƒãƒˆã‚’ç·¨é›†</h3>
        <p id="editTopSlotName" style="color: #aaa; margin-bottom: 15px; font-size: 14px;"></p>
        <input type="text" id="editTopLink" placeholder="YouTubeã®URL">
        <input type="text" id="editTopThumbnail" placeholder="ã‚«ã‚¹ã‚¿ãƒ ã‚µãƒ ãƒã‚¤ãƒ«ï¼ˆä»»æ„ã€ç©ºæ¬„ã§YouTubeã‚µãƒ ãƒä½¿ç”¨ï¼‰">
        <div class="modal-buttons">
          <button class="btn-cancel" onclick="closeTopModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button class="btn-save" onclick="saveTopEdit()">ä¿å­˜</button>
        </div>
      </div>
    </div>

    <!-- Edit Mixing Modal -->
    <div class="modal" id="editModal">
      <div class="modal-content">
        <h3>Mixingå‹•ç”»ã‚’ç·¨é›†</h3>
        <input type="text" id="editTitle" placeholder="ã‚¿ã‚¤ãƒˆãƒ«">
        <input type="text" id="editYoutubeUrl" placeholder="YouTubeã®URL">
        <input type="text" id="editThumbnail" placeholder="ã‚«ã‚¹ã‚¿ãƒ ã‚µãƒ ãƒã‚¤ãƒ«ï¼ˆä»»æ„ï¼‰">
        <div class="modal-buttons">
          <button class="btn-cancel" onclick="closeModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button class="btn-save" onclick="saveEdit()">ä¿å­˜</button>
        </div>
      </div>
    </div>

    <!-- Edit Music Modal -->
    <div class="modal" id="editMusicModal">
      <div class="modal-content">
        <h3>éŸ³æºã‚’ç·¨é›†</h3>
        <input type="text" id="editMusicTitle" placeholder="æ›²å">
        <input type="text" id="editSoundcloudUrl" placeholder="SoundCloudã®URL">
        <div class="modal-buttons">
          <button class="btn-cancel" onclick="closeMusicModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button class="btn-save" onclick="saveMusicEdit()">ä¿å­˜</button>
        </div>
      </div>
    </div>

    <!-- Edit 3D Animation Modal -->
    <div class="modal" id="edit3dModal">
      <div class="modal-content">
        <h3>3D Animationå‹•ç”»ã‚’ç·¨é›†</h3>
        <input type="text" id="edit3dTitle" placeholder="ã‚¿ã‚¤ãƒˆãƒ«">
        <input type="text" id="edit3dYoutubeUrl" placeholder="YouTubeã®URL">
        <div class="modal-buttons">
          <button class="btn-cancel" onclick="close3dModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button class="btn-save" onclick="save3dEdit()">ä¿å­˜</button>
        </div>
      </div>
    </div>

    <!-- Edit Planning Modal -->
    <div class="modal" id="editPlanningModal">
      <div class="modal-content">
        <h3>Planningä½œå“ã‚’ç·¨é›†</h3>
        <input type="text" id="editPlanningTitle" placeholder="ä½œå“ã‚¿ã‚¤ãƒˆãƒ«">
        <input type="text" id="editPlanningYoutubeUrl" placeholder="YouTubeã®URL">
        <div class="modal-buttons">
          <button class="btn-cancel" onclick="closePlanningModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button class="btn-save" onclick="savePlanningEdit()">ä¿å­˜</button>
        </div>
      </div>
    </div>

    <!-- Edit Plugin Modal -->
    <div class="modal" id="editPluginModal">
      <div class="modal-content">
        <h3>ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ç·¨é›†</h3>
        <input type="text" id="editPluginTitle" placeholder="ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å">
        <input type="text" id="editPluginDescription" placeholder="èª¬æ˜">
        <input type="text" id="editPluginLink" placeholder="ãƒªãƒ³ã‚¯URL">
        <input type="text" id="editPluginTag" placeholder="ã‚«ãƒ†ã‚´ãƒªã‚¿ã‚°">
        <div class="modal-buttons">
          <button class="btn-cancel" onclick="closePluginModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button class="btn-save" onclick="savePluginEdit()">ä¿å­˜</button>
        </div>
      </div>
    </div>

    <div class="save-status" id="saveStatus">ä¿å­˜ã—ã¾ã—ãŸ</div>
  </div>

  <script>
    // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¨­å®š
    const ADMIN_PASSWORD = 'abc99387';

    // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã‚­ãƒ¼
    const STORAGE_KEY = 'portfolio_videos';
    const MUSIC_STORAGE_KEY = 'portfolio_music';
    const ANIMATION3D_STORAGE_KEY = 'portfolio_3d_animation';
    const PLANNING_STORAGE_KEY = 'portfolio_planning';
    const TOP_STORAGE_KEY = 'portfolio_top_videos';

    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å‹•ç”»ãƒ‡ãƒ¼ã‚¿
    const defaultVideos = [
      { id: '3qpLV6US96M', title: '18æ­³ãŒ / å…¨åŠ›ã§ã€åŒ–ã‘ã®èŠ±ã€‘æ­Œã£ã¦ã¿ãŸ', link: 'https://www.youtube.com/watch?v=3qpLV6US96M' },
      { id: 'XP-nYV8GAOo', title: "Hell's Greatest Dad/Hazbin Hotel - ver.Rim", link: 'https://www.youtube.com/watch?v=XP-nYV8GAOo' },
      { id: 'd21zmSD-Oh4', title: 'ã€æ€œå·³ã€‘ç™¾èŠ±ç¹šä¹±â˜†ã‚¹ã‚¿ãƒ¼ãƒã‚¤ãƒ³ / é›ªä¹ƒã‚¤ãƒˆã€æ­Œã£ã¦ã¿ãŸã€‘', link: 'https://www.youtube.com/watch?v=d21zmSD-Oh4' },
      { id: '6hn1pNWSCNI', title: 'ã€ãŠåŒ–ã‘5äººãŒã€‘HALLOWEEN PARTY/æ­Œã£ã¦ã¿ãŸã€ã©ã‚‹ã‚Œãã€‘', link: 'https://www.youtube.com/watch?v=6hn1pNWSCNI' },
      { id: 'Ag9Ay7XJC24', title: 'ã€ã‚ªãƒªã‚¸ãƒŠãƒ«MVã€‘è„±æ³•ãƒ­ãƒƒã‚¯ï¼æ­Œã£ã¦ã¿ãŸã€ã‚ã½ã™Ã—ã¿ã¬ãŸã€‘', link: 'https://www.youtube.com/watch?v=Ag9Ay7XJC24' },
      { id: 'KWbXAIrVWxk', title: 'ãƒ•ã‚¡ã‚¿ãƒ¼ãƒ« / GEMN æ­Œã£ã¦ã¿ãŸ ã€ã¾ã„ãŸã‘xã‹ã«ã¡ã‚ƒã‚“ã€‘', link: 'https://www.youtube.com/watch?v=KWbXAIrVWxk' },
      { id: 'ArdkSMvRqxo', title: 'ãƒã‚ª / æ­Œã£ã¦ã¿ãŸã€ã¿ãã‚‰ã€‘', link: 'https://www.youtube.com/watch?v=ArdkSMvRqxo' },
      { id: 'khYh9nJxO9o', title: 'Love Forever - ã‚¸ãƒ§ã‚¢ãƒ³ãƒŠç”ºç”°Ã—ç·‹èµ¤ã¾ã„(Cover)', link: 'https://www.youtube.com/watch?v=khYh9nJxO9o' },
      { id: '2X77fyZSIM4', title: 'ã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒ»ãƒã‚¶ãƒ¼ã‚°ãƒ¼ã‚¹(wowaka)/å°¾é•·çœŸæ˜¼cover', link: 'https://www.youtube.com/watch?v=2X77fyZSIM4' },
      { id: 'VVUW23SBnoE', title: 'ã‚»ãƒªãƒ•ã‚ã‚Šã§ã€‘ã‚­ãƒ³ã‚°ã‚¹ãƒ¬ã‚¤ãƒ¤ãƒ¼ / ã‚ã‚Œã¨ã€æ­Œã£ã¦ã¿ãŸ / ã‚ã‚‹ã·ã‚Œã€‘', link: 'https://www.youtube.com/watch?v=VVUW23SBnoE' },
      { id: '-W3QisNkoCQ', title: 'ã€ä¸‰å…„å¼Ÿã§ã€‘ã®ã  / æ­Œã£ã¦ã¿ãŸ ã€ã¾ãã™ã¨ã€‘', link: 'https://www.youtube.com/watch?v=-W3QisNkoCQ' },
      { id: 'Et7CpkC1ilI', title: 'ã€ãƒœã‚«ãƒ‡ãƒ¥ã‚ª2024ã€‘ã€€æ³¡æ²«ã€€Team éŸ¿æ›²ã€œkyomaã€œ', link: 'https://www.youtube.com/watch?v=Et7CpkC1ilI' },
      { id: 'PBd2yrrnZ-4', title: 'UNDEAD/cover.ãƒã‚¢', link: 'https://www.youtube.com/watch?v=PBd2yrrnZ-4' },
      { id: 'ZSEfPjaEjEs', title: 'ã€æ­Œã£ã¦ã¿ãŸã€‘ç§ã¯ã€ç§é”ã¯(Guiano)/å°¾é•·çœŸæ˜¼cover', link: 'https://www.youtube.com/watch?v=ZSEfPjaEjEs' },
      { id: 'BAFzZ3hgccU', title: 'ã€ã‚·ãƒ§ã‚¿ã‚«ãƒ†é…ä¿¡è€…ãŒã€‘3å‘¨å¹´è¨˜å¿µã«ã€ã—ã‚ã€‘æ­Œã£ã¦ã¿ãŸ', link: 'https://www.youtube.com/watch?v=BAFzZ3hgccU' },
      { id: '73K8Q4F-Uo0', title: 'ã€ã‚¢ãƒ‹ãƒ¡è³­ã‚±ã‚°ãƒ«ã‚¤OPã€‘Deal with the devil / coverã¯ãªã¾ã‚‹', link: 'https://www.youtube.com/watch?v=73K8Q4F-Uo0' },
      { id: 'wXdpFwtZk5A', title: 'Tonight ~æœˆã®ä¸‹çœ ã‚‹å›~ - ãƒã‚¯ãƒ‰ãƒŠãƒ«ãƒ‰ï½¥ã‚¸ãƒ§ã‚¢ãƒ³ãƒŠï½¥ã¾ã„ (Cover)', link: 'https://www.youtube.com/watch?v=wXdpFwtZk5A' }
    ];

    let videos = [];
    let musicList = [];
    let animation3dList = [];
    let planningList = [];
    let topSlots = [];
    let editIndex = -1;
    let editMusicIndex = -1;
    let edit3dIndex = -1;
    let editPlanningIndex = -1;
    let editTopIndex = -1;

    // TOPãƒšãƒ¼ã‚¸ã®ã‚¹ãƒ­ãƒƒãƒˆå®šç¾©ï¼ˆä½ç½®ã¯å›ºå®šã€å‹•ç”»æƒ…å ±ã®ã¿ç·¨é›†å¯èƒ½ï¼‰
    const defaultTopSlots = [
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ1: Deal with the devilï¼ˆå¤§ï¼‰', link: 'https://www.youtube.com/watch?v=73K8Q4F-Uo0', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ2: ãƒã‚ªï¼ˆç¸¦é•·ï¼‰', link: 'https://www.youtube.com/watch?v=ArdkSMvRqxo', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ3: ç™¾èŠ±ç¹šä¹±ï¼ˆæ¨ªé•·ï¼‰', link: 'https://www.youtube.com/watch?v=d21zmSD-Oh4', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ4: ã®ã ï¼ˆæ¨ªé•·ï¼‰', link: 'https://www.youtube.com/watch?v=-W3QisNkoCQ', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ5: ã—ã‚ï¼ˆç¸¦é•·ï¼‰', link: 'https://www.youtube.com/watch?v=BAFzZ3hgccU', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ6: HALLOWEEN PARTYï¼ˆæ¨ªé•·ï¼‰', link: 'https://www.youtube.com/watch?v=6hn1pNWSCNI', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ7: æ³¡æ²«ï¼ˆç¸¦é•·ï¼‰', link: 'https://www.youtube.com/watch?v=Et7CpkC1ilI', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ8: è„±æ³•ãƒ­ãƒƒã‚¯ï¼ˆæ¨ªé•·ï¼‰', link: 'https://www.youtube.com/watch?v=Ag9Ay7XJC24', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ9: UNDEADï¼ˆç¸¦é•·ï¼‰', link: 'https://www.youtube.com/watch?v=PBd2yrrnZ-4', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ10: Hells Greatest Dadï¼ˆæ¨ªé•·ï¼‰', link: 'https://www.youtube.com/watch?v=XP-nYV8GAOo', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ11: Love Foreverï¼ˆæ¨ªé•·ï¼‰', link: 'https://www.youtube.com/watch?v=khYh9nJxO9o', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ12: ã‚¢ãƒ³ãƒã‚¦ãƒ³ï¼ˆç¸¦é•·ï¼‰', link: 'https://www.youtube.com/watch?v=2X77fyZSIM4', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ13: Tonightï¼ˆæ¨ªé•·ï¼‰', link: 'https://www.youtube.com/watch?v=wXdpFwtZk5A', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ14: ã‚­ãƒ³ã‚°ã‚¹ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆç¸¦é•·ï¼‰', link: 'https://www.youtube.com/watch?v=VVUW23SBnoE', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ15: ãƒ•ã‚¡ã‚¿ãƒ¼ãƒ«ï¼ˆæ¨ªé•·ï¼‰', link: 'https://www.youtube.com/watch?v=KWbXAIrVWxk', customThumbnail: '' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ16: ç§ã¯ã€ç§é”ã¯ï¼ˆæ¨ªé•·ï¼‰', link: 'https://www.youtube.com/watch?v=ZSEfPjaEjEs', customThumbnail: 'images/onaga-saisho.jpg' },
      { slotName: 'ã‚¹ãƒ­ãƒƒãƒˆ17: åŒ–ã‘ã®èŠ±ï¼ˆæœ€å¤§ï¼‰', link: 'https://www.youtube.com/watch?v=3qpLV6US96M', customThumbnail: '' }
    ];

    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®3Dã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿
    const default3dVideos = [
      { id: 'YlREYofJlZU', title: '3D Animation 1', link: 'https://www.youtube.com/watch?v=YlREYofJlZU' },
      { id: 'FQwnJEvqYfE', title: '3D Animation 2', link: 'https://www.youtube.com/watch?v=FQwnJEvqYfE' },
      { id: '_J-Dhutoz_k', title: '3D Animation 3', link: 'https://www.youtube.com/watch?v=_J-Dhutoz_k' }
    ];

    // åˆæœŸåŒ–
    function init() {
      // TOPã‚¹ãƒ­ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿
      const savedTop = localStorage.getItem(TOP_STORAGE_KEY);
      if (savedTop) {
        const parsed = JSON.parse(savedTop);
        // æ–°ã—ã„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆslotNameã‚’æŒã¤ï¼‰ã‹ãƒã‚§ãƒƒã‚¯
        if (parsed.length > 0 && parsed[0].slotName) {
          topSlots = parsed;
        } else {
          // å¤ã„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®å ´åˆã¯ãƒªã‚»ãƒƒãƒˆ
          topSlots = JSON.parse(JSON.stringify(defaultTopSlots));
          saveTopSlots();
        }
      } else {
        topSlots = JSON.parse(JSON.stringify(defaultTopSlots));
        saveTopSlots();
      }

      // Mixingå‹•ç”»ãƒ‡ãƒ¼ã‚¿
      const saved = localStorage.getItem(STORAGE_KEY);
      if (saved) {
        videos = JSON.parse(saved);
      } else {
        videos = [...defaultVideos];
        saveVideos();
      }

      // éŸ³æºãƒ‡ãƒ¼ã‚¿
      const savedMusic = localStorage.getItem(MUSIC_STORAGE_KEY);
      if (savedMusic) {
        musicList = JSON.parse(savedMusic);
      } else {
        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®éŸ³æºãƒ‡ãƒ¼ã‚¿
        musicList = [
          { title: '01a1', embedUrl: 'https://w.soundcloud.com/player/?url=https%3A%2F%2Fsoundcloud.com%2Fhx62trzckls7%2F01a1&color=%23926bff&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=true&visual=true', originalUrl: 'https://soundcloud.com/hx62trzckls7/01a1' },
          { title: '02a', embedUrl: 'https://w.soundcloud.com/player/?url=https%3A%2F%2Fsoundcloud.com%2Fhx62trzckls7%2F02a&color=%23926bff&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=true&visual=true', originalUrl: 'https://soundcloud.com/hx62trzckls7/02a' },
          { title: '03a', embedUrl: 'https://w.soundcloud.com/player/?url=https%3A%2F%2Fsoundcloud.com%2Fhx62trzckls7%2F03a&color=%23926bff&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=true&visual=true', originalUrl: 'https://soundcloud.com/hx62trzckls7/03a' },
          { title: '04a', embedUrl: 'https://w.soundcloud.com/player/?url=https%3A%2F%2Fsoundcloud.com%2Fhx62trzckls7%2F04a&color=%23926bff&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=true&visual=true', originalUrl: 'https://soundcloud.com/hx62trzckls7/04a' },
          { title: '05wav', embedUrl: 'https://w.soundcloud.com/player/?url=https%3A%2F%2Fsoundcloud.com%2Fhx62trzckls7%2F05wav&color=%23926bff&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=true&visual=true', originalUrl: 'https://soundcloud.com/hx62trzckls7/05wav' },
          { title: '06a1', embedUrl: 'https://w.soundcloud.com/player/?url=https%3A%2F%2Fsoundcloud.com%2Fhx62trzckls7%2F06a1&color=%23926bff&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=true&visual=true', originalUrl: 'https://soundcloud.com/hx62trzckls7/06a1' }
        ];
        saveMusic();
      }

      // 3Dã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿
      const saved3d = localStorage.getItem(ANIMATION3D_STORAGE_KEY);
      if (saved3d) {
        animation3dList = JSON.parse(saved3d);
      } else {
        animation3dList = [...default3dVideos];
        save3dVideos();
      }

      // Planningãƒ‡ãƒ¼ã‚¿
      const savedPlanning = localStorage.getItem(PLANNING_STORAGE_KEY);
      if (savedPlanning) {
        planningList = JSON.parse(savedPlanning);
      } else {
        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®Planningãƒ‡ãƒ¼ã‚¿
        planningList = [
          { id: 'UAV_q6xKtu4', title: 'ãƒ‰ã‚­ã‚·ãƒƒã‚¯/ã‹ã‚ã„ã„JKãµãã‚“å€¶æ¥½éƒ¨', link: 'https://www.youtube.com/watch?v=UAV_q6xKtu4' }
        ];
        savePlanning();
      }

      // ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ç¢ºèªï¼ˆè‡ªå‹•ãƒ­ã‚°ã‚¤ãƒ³å¯¾å¿œï¼‰
      if (localStorage.getItem('admin_logged_in') === 'true') {
        showAdminPanel();
      }
    }

    // ãƒ­ã‚°ã‚¤ãƒ³
    function login() {
      const password = document.getElementById('passwordInput').value;
      if (password === ADMIN_PASSWORD) {
        localStorage.setItem('admin_logged_in', 'true');
        showAdminPanel();
      } else {
        document.getElementById('loginError').textContent = 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™';
      }
    }

    // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
    function logout() {
      localStorage.removeItem('admin_logged_in');
      document.getElementById('loginContainer').style.display = 'flex';
      document.getElementById('adminPanel').style.display = 'none';
      document.getElementById('passwordInput').value = '';
    }

    // ç®¡ç†ãƒ‘ãƒãƒ«è¡¨ç¤º
    function showAdminPanel() {
      document.getElementById('loginContainer').style.display = 'none';
      document.getElementById('adminPanel').style.display = 'block';
      renderTopList();
      renderVideoList();
      render3dList();
      renderMusicList();
      renderPlanningList();
      loadPlugins();
    }

    // å‹•ç”»ãƒªã‚¹ãƒˆè¡¨ç¤º
    function renderVideoList() {
      const list = document.getElementById('mixingVideoList');
      list.innerHTML = '';

      if (videos.length === 0) {
        list.innerHTML = '<p style="color: #999; text-align: center; padding: 20px;">å‹•ç”»ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“</p>';
        return;
      }

      videos.forEach((video, index) => {
        let thumbnailId = video.id;
        if (video.link) {
          const match = video.link.match(/[?&]v=([^&]+)/);
          if (match) thumbnailId = match[1];
        }

        const thumbnailUrl = video.customThumbnail || `https://img.youtube.com/vi/${thumbnailId}/mqdefault.jpg`;

        const videoLink = video.link || `https://www.youtube.com/watch?v=${thumbnailId}`;

        const item = document.createElement('div');
        item.className = 'video-item';
        item.innerHTML = `
          <div class="video-number">
            <input type="number" value="${index + 1}" min="1" max="${videos.length}" onchange="moveVideoToPosition(${index}, this.value)" title="é †ç•ªã‚’å¤‰æ›´">
          </div>
          <a href="${videoLink}" target="_blank" style="display: block;">
            <img src="${thumbnailUrl}" alt="${video.title}" onerror="this.src='https://img.youtube.com/vi/${video.id}/mqdefault.jpg'" style="cursor: pointer;">
          </a>
          <div class="video-info">
            <h4>${video.title}</h4>
            <p>ID: ${video.id}</p>
          </div>
          <div class="video-actions">
            <button class="btn-edit" onclick="openEdit(${index})">ç·¨é›†</button>
            <button class="btn-delete" onclick="deleteVideo(${index})">å‰Šé™¤</button>
          </div>
        `;
        list.appendChild(item);
      });
    }

    // YouTubeã®URLã‹ã‚‰å‹•ç”»IDã‚’æŠ½å‡º
    function extractVideoId(url) {
      // æ§˜ã€…ãªYouTube URLãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¯¾å¿œ
      const patterns = [
        /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/|youtube\.com\/v\/)([^&\n?#]+)/,
        /^([a-zA-Z0-9_-]{11})$/  // å‹•ç”»IDã®ã¿ã®å ´åˆ
      ];

      for (const pattern of patterns) {
        const match = url.match(pattern);
        if (match) {
          return match[1];
        }
      }
      return null;
    }

    // å‹•ç”»è¿½åŠ 
    function addVideo() {
      const title = document.getElementById('newTitle').value.trim();
      const youtubeUrl = document.getElementById('newYoutubeUrl').value.trim();
      const thumbnail = document.getElementById('newThumbnail').value.trim();

      if (!title || !youtubeUrl) {
        alert('ã‚¿ã‚¤ãƒˆãƒ«ã¨YouTubeã®URLã¯å¿…é ˆã§ã™');
        return;
      }

      const videoId = extractVideoId(youtubeUrl);
      if (!videoId) {
        alert('æœ‰åŠ¹ãªYouTubeã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      const newVideo = {
        id: videoId,
        title: title,
        link: youtubeUrl
      };

      if (thumbnail) {
        newVideo.customThumbnail = thumbnail;
      }

      videos.unshift(newVideo);
      saveVideos();
      renderVideoList();

      // ãƒ•ã‚©ãƒ¼ãƒ ã‚¯ãƒªã‚¢
      document.getElementById('newTitle').value = '';
      document.getElementById('newYoutubeUrl').value = '';
      document.getElementById('newThumbnail').value = '';

      showSaveStatus();
    }

    // å‹•ç”»å‰Šé™¤
    function deleteVideo(index) {
      if (confirm(`ã€Œ${videos[index].title}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
        videos.splice(index, 1);
        saveVideos();
        renderVideoList();
        showSaveStatus();
      }
    }

    // Mixingå‹•ç”»ã‚’æŒ‡å®šä½ç½®ã«ç§»å‹•
    function moveVideoToPosition(currentIndex, newPosition) {
      const targetIndex = parseInt(newPosition) - 1;
      if (isNaN(targetIndex) || targetIndex < 0 || targetIndex >= videos.length || targetIndex === currentIndex) {
        renderVideoList(); // ç„¡åŠ¹ãªå€¤ã®å ´åˆã¯ãƒªã‚»ãƒƒãƒˆ
        return;
      }

      const item = videos.splice(currentIndex, 1)[0];
      videos.splice(targetIndex, 0, item);
      saveVideos();
      renderVideoList();
      showSaveStatus();
    }

    // ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
    function openEdit(index) {
      editIndex = index;
      const video = videos[index];
      document.getElementById('editTitle').value = video.title;
      document.getElementById('editYoutubeUrl').value = video.link || `https://www.youtube.com/watch?v=${video.id}`;
      document.getElementById('editThumbnail').value = video.customThumbnail || '';
      document.getElementById('editModal').style.display = 'flex';
    }

    // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
    function closeModal() {
      document.getElementById('editModal').style.display = 'none';
      editIndex = -1;
    }

    // ç·¨é›†ã‚’ä¿å­˜
    function saveEdit() {
      if (editIndex === -1) return;

      const title = document.getElementById('editTitle').value.trim();
      const youtubeUrl = document.getElementById('editYoutubeUrl').value.trim();
      const thumbnail = document.getElementById('editThumbnail').value.trim();

      if (!title || !youtubeUrl) {
        alert('ã‚¿ã‚¤ãƒˆãƒ«ã¨YouTubeã®URLã¯å¿…é ˆã§ã™');
        return;
      }

      const videoId = extractVideoId(youtubeUrl);
      if (!videoId) {
        alert('æœ‰åŠ¹ãªYouTubeã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      videos[editIndex] = {
        id: videoId,
        title: title,
        link: youtubeUrl
      };

      if (thumbnail) {
        videos[editIndex].customThumbnail = thumbnail;
      }

      saveVideos();
      renderVideoList();
      closeModal();
      showSaveStatus();
    }

    // ä¿å­˜
    function saveVideos() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(videos));
    }

    // ========== TOPç®¡ç†æ©Ÿèƒ½ ==========

    // TOPãƒªã‚¹ãƒˆè¡¨ç¤º
    function renderTopList() {
      const list = document.getElementById('topVideoList');
      list.innerHTML = '';

      topSlots.forEach((slot, index) => {
        // ãƒªãƒ³ã‚¯ã‹ã‚‰ãƒ“ãƒ‡ã‚ªIDã‚’æŠ½å‡º
        let videoId = '';
        if (slot.link) {
          const match = slot.link.match(/[?&]v=([^&]+)/);
          if (match) videoId = match[1];
        }

        const thumbnailUrl = slot.customThumbnail || (videoId ? `https://img.youtube.com/vi/${videoId}/mqdefault.jpg` : '');

        const item = document.createElement('div');
        item.className = 'video-item';
        item.innerHTML = `
          <div class="video-number" style="min-width: 40px;">
            <span style="color: #fff; font-weight: bold;">${index + 1}</span>
          </div>
          ${thumbnailUrl ? `
            <a href="${slot.link}" target="_blank" style="display: block;">
              <img src="${thumbnailUrl}" alt="${slot.slotName}" onerror="this.src='https://img.youtube.com/vi/${videoId}/hqdefault.jpg'" style="cursor: pointer;">
            </a>
          ` : `
            <div style="width: 120px; height: 68px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; display: flex; align-items: center; justify-content: center;">
              <span style="color: #999;">No Video</span>
            </div>
          `}
          <div class="video-info">
            <h4>${slot.slotName}</h4>
            <p style="font-size: 11px; word-break: break-all;">${slot.link || 'æœªè¨­å®š'}</p>
            ${slot.customThumbnail ? `<p style="font-size: 10px; color: #ccc;">ã‚«ã‚¹ã‚¿ãƒ ã‚µãƒ ãƒ: ${slot.customThumbnail}</p>` : ''}
          </div>
          <div class="video-actions">
            <button class="btn-edit" onclick="openTopEdit(${index})">ç·¨é›†</button>
          </div>
        `;
        list.appendChild(item);
      });
    }

    // TOPç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
    function openTopEdit(index) {
      editTopIndex = index;
      const slot = topSlots[index];
      document.getElementById('editTopSlotName').textContent = slot.slotName;
      document.getElementById('editTopLink').value = slot.link || '';
      document.getElementById('editTopThumbnail').value = slot.customThumbnail || '';
      document.getElementById('editTopModal').style.display = 'flex';
    }

    // TOPãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
    function closeTopModal() {
      document.getElementById('editTopModal').style.display = 'none';
      editTopIndex = -1;
    }

    // TOPç·¨é›†ã‚’ä¿å­˜
    function saveTopEdit() {
      if (editTopIndex === -1) return;

      const link = document.getElementById('editTopLink').value.trim();
      const thumbnail = document.getElementById('editTopThumbnail').value.trim();

      if (!link) {
        alert('YouTubeã®URLã¯å¿…é ˆã§ã™');
        return;
      }

      // URLã®åŸºæœ¬ãƒã‚§ãƒƒã‚¯
      if (!link.includes('youtube.com') && !link.includes('youtu.be')) {
        alert('æœ‰åŠ¹ãªYouTubeã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      topSlots[editTopIndex].link = link;
      topSlots[editTopIndex].customThumbnail = thumbnail;

      saveTopSlots();
      renderTopList();
      closeTopModal();
      showSaveStatus();
    }

    // TOPã‚¹ãƒ­ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
    function saveTopSlots() {
      localStorage.setItem(TOP_STORAGE_KEY, JSON.stringify(topSlots));
    }

    // ========== ã“ã“ã¾ã§TOPç®¡ç†æ©Ÿèƒ½ ==========

    // ä¿å­˜ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
    function showSaveStatus() {
      const status = document.getElementById('saveStatus');
      status.style.display = 'block';
      setTimeout(() => {
        status.style.display = 'none';
      }, 2000);
    }

    // ========== Musicç®¡ç†æ©Ÿèƒ½ ==========

    // SoundCloudã®URLã‚’åŸ‹ã‚è¾¼ã¿URLã«å¤‰æ›
    function convertToSoundcloudEmbed(url) {
      // SoundCloudã®åŸ‹ã‚è¾¼ã¿URLå½¢å¼ã«å¤‰æ›
      // https://soundcloud.com/artist/track -> https://w.soundcloud.com/player/?url=...
      const encodedUrl = encodeURIComponent(url);
      return `https://w.soundcloud.com/player/?url=${encodedUrl}&color=%23926bff&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=false`;
    }

    // éŸ³æºãƒªã‚¹ãƒˆè¡¨ç¤º
    function renderMusicList() {
      const list = document.getElementById('musicList');
      list.innerHTML = '';

      if (musicList.length === 0) {
        list.innerHTML = '<p style="color: #999; text-align: center; padding: 20px;">éŸ³æºãŒã¾ã ã‚ã‚Šã¾ã›ã‚“</p>';
        return;
      }

      musicList.forEach((track, index) => {
        const item = document.createElement('div');
        item.className = 'video-item';
        item.innerHTML = `
          <div class="video-number">
            <input type="number" value="${index + 1}" min="1" max="${musicList.length}" onchange="moveMusicToPosition(${index}, this.value)" title="é †ç•ªã‚’å¤‰æ›´">
          </div>
          <a href="${track.originalUrl || '#'}" target="_blank" style="display: block; width: 120px; height: 68px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
            <span style="font-size: 24px;">ğŸµ</span>
          </a>
          <div class="video-info">
            <h4>${track.title}</h4>
            <p style="font-size: 11px; word-break: break-all;">${track.originalUrl || 'SoundCloud'}</p>
          </div>
          <div class="video-actions">
            <button class="btn-edit" onclick="openMusicEdit(${index})">ç·¨é›†</button>
            <button class="btn-delete" onclick="deleteMusic(${index})">å‰Šé™¤</button>
          </div>
        `;
        list.appendChild(item);
      });
    }

    // éŸ³æºè¿½åŠ 
    function addMusic() {
      const title = document.getElementById('newMusicTitle').value.trim();
      const soundcloudUrl = document.getElementById('newSoundcloudUrl').value.trim();

      if (!title || !soundcloudUrl) {
        alert('æ›²åã¨SoundCloudã®URLã¯å¿…é ˆã§ã™');
        return;
      }

      // SoundCloudã®URLæ¤œè¨¼ï¼ˆåŸºæœ¬çš„ãªãƒã‚§ãƒƒã‚¯ï¼‰
      if (!soundcloudUrl.includes('soundcloud.com')) {
        alert('æœ‰åŠ¹ãªSoundCloudã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      const embedUrl = convertToSoundcloudEmbed(soundcloudUrl);

      const newTrack = {
        title: title,
        embedUrl: embedUrl,
        originalUrl: soundcloudUrl
      };

      musicList.unshift(newTrack);
      saveMusic();
      renderMusicList();

      // ãƒ•ã‚©ãƒ¼ãƒ ã‚¯ãƒªã‚¢
      document.getElementById('newMusicTitle').value = '';
      document.getElementById('newSoundcloudUrl').value = '';

      showSaveStatus();
    }

    // éŸ³æºå‰Šé™¤
    function deleteMusic(index) {
      if (confirm(`ã€Œ${musicList[index].title}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
        musicList.splice(index, 1);
        saveMusic();
        renderMusicList();
        showSaveStatus();
      }
    }

    // éŸ³æºã‚’æŒ‡å®šä½ç½®ã«ç§»å‹•
    function moveMusicToPosition(currentIndex, newPosition) {
      const targetIndex = parseInt(newPosition) - 1;
      if (isNaN(targetIndex) || targetIndex < 0 || targetIndex >= musicList.length || targetIndex === currentIndex) {
        renderMusicList(); // ç„¡åŠ¹ãªå€¤ã®å ´åˆã¯ãƒªã‚»ãƒƒãƒˆ
        return;
      }

      const item = musicList.splice(currentIndex, 1)[0];
      musicList.splice(targetIndex, 0, item);
      saveMusic();
      renderMusicList();
      showSaveStatus();
    }

    // éŸ³æºç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
    function openMusicEdit(index) {
      editMusicIndex = index;
      const track = musicList[index];
      document.getElementById('editMusicTitle').value = track.title;
      document.getElementById('editSoundcloudUrl').value = track.originalUrl || '';
      document.getElementById('editMusicModal').style.display = 'flex';
    }

    // éŸ³æºãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
    function closeMusicModal() {
      document.getElementById('editMusicModal').style.display = 'none';
      editMusicIndex = -1;
    }

    // éŸ³æºç·¨é›†ã‚’ä¿å­˜
    function saveMusicEdit() {
      if (editMusicIndex === -1) return;

      const title = document.getElementById('editMusicTitle').value.trim();
      const soundcloudUrl = document.getElementById('editSoundcloudUrl').value.trim();

      if (!title || !soundcloudUrl) {
        alert('æ›²åã¨SoundCloudã®URLã¯å¿…é ˆã§ã™');
        return;
      }

      if (!soundcloudUrl.includes('soundcloud.com')) {
        alert('æœ‰åŠ¹ãªSoundCloudã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      const embedUrl = convertToSoundcloudEmbed(soundcloudUrl);

      musicList[editMusicIndex] = {
        title: title,
        embedUrl: embedUrl,
        originalUrl: soundcloudUrl
      };

      saveMusic();
      renderMusicList();
      closeMusicModal();
      showSaveStatus();
    }

    // éŸ³æºãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
    function saveMusic() {
      localStorage.setItem(MUSIC_STORAGE_KEY, JSON.stringify(musicList));
    }

    // ========== ã“ã“ã¾ã§Musicç®¡ç†æ©Ÿèƒ½ ==========

    // ========== 3D Animationç®¡ç†æ©Ÿèƒ½ ==========

    // 3Dã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒªã‚¹ãƒˆè¡¨ç¤º
    function render3dList() {
      const list = document.getElementById('animation3dList');
      list.innerHTML = '';

      if (animation3dList.length === 0) {
        list.innerHTML = '<p style="color: #999; text-align: center; padding: 20px;">å‹•ç”»ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“</p>';
        return;
      }

      animation3dList.forEach((video, index) => {
        const thumbnailUrl = `https://img.youtube.com/vi/${video.id}/mqdefault.jpg`;
        const videoLink = video.link || `https://www.youtube.com/watch?v=${video.id}`;

        const item = document.createElement('div');
        item.className = 'video-item';
        item.innerHTML = `
          <div class="video-number">
            <input type="number" value="${index + 1}" min="1" max="${animation3dList.length}" onchange="move3dToPosition(${index}, this.value)" title="é †ç•ªã‚’å¤‰æ›´">
          </div>
          <a href="${videoLink}" target="_blank" style="display: block;">
            <img src="${thumbnailUrl}" alt="${video.title}" onerror="this.src='https://img.youtube.com/vi/${video.id}/hqdefault.jpg'" style="cursor: pointer;">
          </a>
          <div class="video-info">
            <h4>${video.title}</h4>
            <p>ID: ${video.id}</p>
          </div>
          <div class="video-actions">
            <button class="btn-edit" onclick="open3dEdit(${index})">ç·¨é›†</button>
            <button class="btn-delete" onclick="delete3dVideo(${index})">å‰Šé™¤</button>
          </div>
        `;
        list.appendChild(item);
      });
    }

    // 3Då‹•ç”»è¿½åŠ 
    function add3dVideo() {
      const title = document.getElementById('new3dTitle').value.trim();
      const youtubeUrl = document.getElementById('new3dYoutubeUrl').value.trim();

      if (!title || !youtubeUrl) {
        alert('ã‚¿ã‚¤ãƒˆãƒ«ã¨YouTubeã®URLã¯å¿…é ˆã§ã™');
        return;
      }

      const videoId = extractVideoId(youtubeUrl);
      if (!videoId) {
        alert('æœ‰åŠ¹ãªYouTubeã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      const newVideo = {
        id: videoId,
        title: title,
        link: youtubeUrl
      };

      animation3dList.unshift(newVideo);
      save3dVideos();
      render3dList();

      // ãƒ•ã‚©ãƒ¼ãƒ ã‚¯ãƒªã‚¢
      document.getElementById('new3dTitle').value = '';
      document.getElementById('new3dYoutubeUrl').value = '';

      showSaveStatus();
    }

    // 3Då‹•ç”»å‰Šé™¤
    function delete3dVideo(index) {
      if (confirm(`ã€Œ${animation3dList[index].title}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
        animation3dList.splice(index, 1);
        save3dVideos();
        render3dList();
        showSaveStatus();
      }
    }

    // 3Då‹•ç”»ã‚’æŒ‡å®šä½ç½®ã«ç§»å‹•
    function move3dToPosition(currentIndex, newPosition) {
      const targetIndex = parseInt(newPosition) - 1;
      if (isNaN(targetIndex) || targetIndex < 0 || targetIndex >= animation3dList.length || targetIndex === currentIndex) {
        render3dList(); // ç„¡åŠ¹ãªå€¤ã®å ´åˆã¯ãƒªã‚»ãƒƒãƒˆ
        return;
      }

      const item = animation3dList.splice(currentIndex, 1)[0];
      animation3dList.splice(targetIndex, 0, item);
      save3dVideos();
      render3dList();
      showSaveStatus();
    }

    // 3Då‹•ç”»ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
    function open3dEdit(index) {
      edit3dIndex = index;
      const video = animation3dList[index];
      document.getElementById('edit3dTitle').value = video.title;
      document.getElementById('edit3dYoutubeUrl').value = video.link || `https://www.youtube.com/watch?v=${video.id}`;
      document.getElementById('edit3dModal').style.display = 'flex';
    }

    // 3Dãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
    function close3dModal() {
      document.getElementById('edit3dModal').style.display = 'none';
      edit3dIndex = -1;
    }

    // 3Då‹•ç”»ç·¨é›†ã‚’ä¿å­˜
    function save3dEdit() {
      if (edit3dIndex === -1) return;

      const title = document.getElementById('edit3dTitle').value.trim();
      const youtubeUrl = document.getElementById('edit3dYoutubeUrl').value.trim();

      if (!title || !youtubeUrl) {
        alert('ã‚¿ã‚¤ãƒˆãƒ«ã¨YouTubeã®URLã¯å¿…é ˆã§ã™');
        return;
      }

      const videoId = extractVideoId(youtubeUrl);
      if (!videoId) {
        alert('æœ‰åŠ¹ãªYouTubeã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      animation3dList[edit3dIndex] = {
        id: videoId,
        title: title,
        link: youtubeUrl
      };

      save3dVideos();
      render3dList();
      close3dModal();
      showSaveStatus();
    }

    // 3Dã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
    function save3dVideos() {
      localStorage.setItem(ANIMATION3D_STORAGE_KEY, JSON.stringify(animation3dList));
    }

    // ========== ã“ã“ã¾ã§3D Animationç®¡ç†æ©Ÿèƒ½ ==========

    // ========== Planning Progressç®¡ç†æ©Ÿèƒ½ ==========

    // Planningãƒªã‚¹ãƒˆè¡¨ç¤º
    function renderPlanningList() {
      const list = document.getElementById('planningList');
      list.innerHTML = '';

      if (planningList.length === 0) {
        list.innerHTML = '<p style="color: #999; text-align: center; padding: 20px;">ä½œå“ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“</p>';
        return;
      }

      planningList.forEach((video, index) => {
        const thumbnailUrl = `https://img.youtube.com/vi/${video.id}/mqdefault.jpg`;
        const videoLink = video.link || `https://www.youtube.com/watch?v=${video.id}`;

        const item = document.createElement('div');
        item.className = 'video-item';
        item.innerHTML = `
          <div class="video-number">
            <input type="number" value="${index + 1}" min="1" max="${planningList.length}" onchange="movePlanningToPosition(${index}, this.value)" title="é †ç•ªã‚’å¤‰æ›´">
          </div>
          <a href="${videoLink}" target="_blank" style="display: block;">
            <img src="${thumbnailUrl}" alt="${video.title}" onerror="this.src='https://img.youtube.com/vi/${video.id}/hqdefault.jpg'" style="cursor: pointer;">
          </a>
          <div class="video-info">
            <h4>${video.title}</h4>
            <p>ID: ${video.id}</p>
          </div>
          <div class="video-actions">
            <button class="btn-edit" onclick="openPlanningEdit(${index})">ç·¨é›†</button>
            <button class="btn-delete" onclick="deletePlanning(${index})">å‰Šé™¤</button>
          </div>
        `;
        list.appendChild(item);
      });
    }

    // Planningä½œå“è¿½åŠ 
    function addPlanning() {
      const title = document.getElementById('newPlanningTitle').value.trim();
      const youtubeUrl = document.getElementById('newPlanningYoutubeUrl').value.trim();

      if (!title || !youtubeUrl) {
        alert('ä½œå“ã‚¿ã‚¤ãƒˆãƒ«ã¨YouTubeã®URLã¯å¿…é ˆã§ã™');
        return;
      }

      const videoId = extractVideoId(youtubeUrl);
      if (!videoId) {
        alert('æœ‰åŠ¹ãªYouTubeã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      const newVideo = {
        id: videoId,
        title: title,
        link: youtubeUrl
      };

      planningList.unshift(newVideo);
      savePlanning();
      renderPlanningList();

      // ãƒ•ã‚©ãƒ¼ãƒ ã‚¯ãƒªã‚¢
      document.getElementById('newPlanningTitle').value = '';
      document.getElementById('newPlanningYoutubeUrl').value = '';

      showSaveStatus();
    }

    // Planningä½œå“å‰Šé™¤
    function deletePlanning(index) {
      if (confirm(`ã€Œ${planningList[index].title}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
        planningList.splice(index, 1);
        savePlanning();
        renderPlanningList();
        showSaveStatus();
      }
    }

    // Planningä½œå“ã‚’æŒ‡å®šä½ç½®ã«ç§»å‹•
    function movePlanningToPosition(currentIndex, newPosition) {
      const targetIndex = parseInt(newPosition) - 1;
      if (isNaN(targetIndex) || targetIndex < 0 || targetIndex >= planningList.length || targetIndex === currentIndex) {
        renderPlanningList(); // ç„¡åŠ¹ãªå€¤ã®å ´åˆã¯ãƒªã‚»ãƒƒãƒˆ
        return;
      }

      const item = planningList.splice(currentIndex, 1)[0];
      planningList.splice(targetIndex, 0, item);
      savePlanning();
      renderPlanningList();
      showSaveStatus();
    }

    // Planningç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
    function openPlanningEdit(index) {
      editPlanningIndex = index;
      const video = planningList[index];
      document.getElementById('editPlanningTitle').value = video.title;
      document.getElementById('editPlanningYoutubeUrl').value = video.link || `https://www.youtube.com/watch?v=${video.id}`;
      document.getElementById('editPlanningModal').style.display = 'flex';
    }

    // Planningãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
    function closePlanningModal() {
      document.getElementById('editPlanningModal').style.display = 'none';
      editPlanningIndex = -1;
    }

    // Planningç·¨é›†ã‚’ä¿å­˜
    function savePlanningEdit() {
      if (editPlanningIndex === -1) return;

      const title = document.getElementById('editPlanningTitle').value.trim();
      const youtubeUrl = document.getElementById('editPlanningYoutubeUrl').value.trim();

      if (!title || !youtubeUrl) {
        alert('ä½œå“ã‚¿ã‚¤ãƒˆãƒ«ã¨YouTubeã®URLã¯å¿…é ˆã§ã™');
        return;
      }

      const videoId = extractVideoId(youtubeUrl);
      if (!videoId) {
        alert('æœ‰åŠ¹ãªYouTubeã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      planningList[editPlanningIndex] = {
        id: videoId,
        title: title,
        link: youtubeUrl
      };

      savePlanning();
      renderPlanningList();
      closePlanningModal();
      showSaveStatus();
    }

    // Planningãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
    function savePlanning() {
      localStorage.setItem(PLANNING_STORAGE_KEY, JSON.stringify(planningList));
    }

    // ========== ã“ã“ã¾ã§Planning Progressç®¡ç†æ©Ÿèƒ½ ==========

    // ========== Pluginsç®¡ç†æ©Ÿèƒ½ï¼ˆGitHub APIï¼‰ ==========

    // GitHubè¨­å®šï¼ˆå…±é€šï¼‰
    const GITHUB_REPO = 'okazaki893/portfolio-site';
    const GITHUB_BRANCH = 'main';
    const GITHUB_TOKEN_KEY = 'github_access_token';

    const PLUGINS_JSON_PATH = 'data/plugins.json';
    let pluginsList = [];
    let pluginsFileSha = null;
    let editPluginIndex = -1;

    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¢ã‚¤ã‚³ãƒ³SVG
    const pluginIconSVG = `<svg style="width: 40px; height: 40px; fill: #ffffff;" viewBox="0 0 24 24"><path d="M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7s2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"/></svg>`;

    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ä¸€è¦§è¡¨ç¤º
    function renderPluginsList() {
      const listEl = document.getElementById('pluginsList');
      if (!listEl) return;

      if (pluginsList.length === 0) {
        listEl.innerHTML = '<p style="color: #999; text-align: center; padding: 20px;">ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“</p>';
        return;
      }

      listEl.innerHTML = pluginsList.map((plugin, index) => `
        <div class="video-item">
          <div class="video-number">
            <input type="number" value="${index + 1}" min="1" max="${pluginsList.length}"
              onchange="movePluginToPosition(${index}, this.value)"
              onclick="this.select()"
              title="é †ç•ªã‚’å¤‰æ›´">
          </div>
          <div style="width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; background: rgba(255, 255, 255, 0.1); border-radius: 8px;">
            ${pluginIconSVG}
          </div>
          <div class="video-info">
            <h4>${plugin.title}</h4>
            <p style="margin-bottom: 3px;">${plugin.description || ''}</p>
            <p style="font-size: 11px; color: rgba(255, 255, 255, 0.6);">${plugin.link}</p>
            ${plugin.tag ? `<span style="display: inline-block; margin-top: 5px; padding: 2px 8px; background: rgba(255, 255, 255, 0.15); border-radius: 4px; font-size: 11px; color: #bbb;">${plugin.tag}</span>` : ''}
          </div>
          <div class="video-actions">
            <button class="btn-edit" onclick="openPluginEdit(${index})">ç·¨é›†</button>
            <button class="btn-delete" onclick="deletePlugin(${index})">å‰Šé™¤</button>
          </div>
        </div>
      `).join('');
    }

    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è¿½åŠ 
    async function addPlugin() {
      const title = document.getElementById('newPluginTitle').value.trim();
      const description = document.getElementById('newPluginDescription').value.trim();
      const link = document.getElementById('newPluginLink').value.trim();
      const tag = document.getElementById('newPluginTag').value.trim();

      if (!title || !link) {
        alert('ãƒ—ãƒ©ã‚°ã‚¤ãƒ³åã¨ãƒªãƒ³ã‚¯URLã¯å¿…é ˆã§ã™');
        return;
      }

      const newPlugin = {
        title: title,
        description: description,
        link: link,
        tag: tag
      };

      pluginsList.unshift(newPlugin);
      const success = await savePlugins();

      if (success) {
        renderPluginsList();
        // ãƒ•ã‚©ãƒ¼ãƒ ã‚¯ãƒªã‚¢
        document.getElementById('newPluginTitle').value = '';
        document.getElementById('newPluginDescription').value = '';
        document.getElementById('newPluginLink').value = '';
        document.getElementById('newPluginTag').value = '';
        showSaveStatus();
      } else {
        // å¤±æ•—ã—ãŸå ´åˆã¯å…ƒã«æˆ»ã™
        pluginsList.shift();
      }
    }

    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å‰Šé™¤
    async function deletePlugin(index) {
      if (confirm(`ã€Œ${pluginsList[index].title}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
        const deleted = pluginsList.splice(index, 1)[0];
        const success = await savePlugins();

        if (success) {
          renderPluginsList();
          showSaveStatus();
        } else {
          // å¤±æ•—ã—ãŸå ´åˆã¯å…ƒã«æˆ»ã™
          pluginsList.splice(index, 0, deleted);
        }
      }
    }

    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’æŒ‡å®šä½ç½®ã«ç§»å‹•
    async function movePluginToPosition(currentIndex, newPosition) {
      const targetIndex = parseInt(newPosition) - 1;
      if (isNaN(targetIndex) || targetIndex < 0 || targetIndex >= pluginsList.length || targetIndex === currentIndex) {
        renderPluginsList();
        return;
      }

      const item = pluginsList.splice(currentIndex, 1)[0];
      pluginsList.splice(targetIndex, 0, item);
      const success = await savePlugins();

      if (success) {
        renderPluginsList();
        showSaveStatus();
      } else {
        // å¤±æ•—ã—ãŸå ´åˆã¯å…ƒã«æˆ»ã™
        pluginsList.splice(targetIndex, 1);
        pluginsList.splice(currentIndex, 0, item);
        renderPluginsList();
      }
    }

    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
    function openPluginEdit(index) {
      editPluginIndex = index;
      const plugin = pluginsList[index];
      document.getElementById('editPluginTitle').value = plugin.title;
      document.getElementById('editPluginDescription').value = plugin.description || '';
      document.getElementById('editPluginLink').value = plugin.link;
      document.getElementById('editPluginTag').value = plugin.tag || '';
      document.getElementById('editPluginModal').style.display = 'flex';
    }

    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
    function closePluginModal() {
      document.getElementById('editPluginModal').style.display = 'none';
      editPluginIndex = -1;
    }

    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç·¨é›†ã‚’ä¿å­˜
    async function savePluginEdit() {
      if (editPluginIndex === -1) return;

      const title = document.getElementById('editPluginTitle').value.trim();
      const description = document.getElementById('editPluginDescription').value.trim();
      const link = document.getElementById('editPluginLink').value.trim();
      const tag = document.getElementById('editPluginTag').value.trim();

      if (!title || !link) {
        alert('ãƒ—ãƒ©ã‚°ã‚¤ãƒ³åã¨ãƒªãƒ³ã‚¯URLã¯å¿…é ˆã§ã™');
        return;
      }

      const oldPlugin = { ...pluginsList[editPluginIndex] };
      pluginsList[editPluginIndex] = {
        title: title,
        description: description,
        link: link,
        tag: tag
      };

      const success = await savePlugins();

      if (success) {
        renderPluginsList();
        closePluginModal();
        showSaveStatus();
      } else {
        // å¤±æ•—ã—ãŸå ´åˆã¯å…ƒã«æˆ»ã™
        pluginsList[editPluginIndex] = oldPlugin;
      }
    }

    // GitHubã‹ã‚‰ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
    async function loadPlugins() {
      const token = localStorage.getItem(GITHUB_TOKEN_KEY);
      if (!token) {
        // ãƒˆãƒ¼ã‚¯ãƒ³ãŒãªã„å ´åˆã¯JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç›´æ¥èª­ã¿è¾¼ã¿
        try {
          const response = await fetch('data/plugins.json');
          if (response.ok) {
            pluginsList = await response.json();
          }
        } catch (e) {
          console.log('Failed to load local plugins.json');
        }
        renderPluginsList();
        return;
      }

      try {
        const response = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/contents/${PLUGINS_JSON_PATH}?ref=${GITHUB_BRANCH}`, {
          headers: {
            'Authorization': `token ${token}`,
            'Accept': 'application/vnd.github.v3+json'
          }
        });

        if (response.status === 404) {
          pluginsList = [];
          pluginsFileSha = null;
          renderPluginsList();
          return;
        }

        if (!response.ok) {
          throw new Error('Failed to fetch plugins');
        }

        const data = await response.json();
        pluginsFileSha = data.sha;

        // Base64ãƒ‡ã‚³ãƒ¼ãƒ‰
        const content = decodeURIComponent(escape(atob(data.content.replace(/\n/g, ''))));
        pluginsList = JSON.parse(content);
        renderPluginsList();

      } catch (error) {
        console.error('Error loading plugins:', error);
        renderPluginsList();
      }
    }

    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’GitHubã«ä¿å­˜
    async function savePlugins() {
      const token = localStorage.getItem(GITHUB_TOKEN_KEY);
      if (!token) {
        alert('GitHubãƒˆãƒ¼ã‚¯ãƒ³ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚Articlesã‚¿ãƒ–ã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚');
        return false;
      }

      try {
        const content = JSON.stringify(pluginsList, null, 2);
        const encodedContent = btoa(unescape(encodeURIComponent(content)));

        const response = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/contents/${PLUGINS_JSON_PATH}`, {
          method: 'PUT',
          headers: {
            'Authorization': `token ${token}`,
            'Accept': 'application/vnd.github.v3+json',
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            message: 'Update plugins via admin',
            content: encodedContent,
            sha: pluginsFileSha,
            branch: GITHUB_BRANCH
          })
        });

        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.message || 'Failed to save plugins');
        }

        const result = await response.json();
        pluginsFileSha = result.content.sha;

        // ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ãƒˆãƒªã‚¬ãƒ¼
        await triggerDeploy();

        return true;

      } catch (error) {
        console.error('Error saving plugins:', error);
        alert('ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
        return false;
      }
    }

    // ========== ã“ã“ã¾ã§Pluginsç®¡ç†æ©Ÿèƒ½ ==========

    // ========== ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ ==========

    function switchTab(tabName, saveState = true) {
      // ã™ã¹ã¦ã®ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã‹ã‚‰activeã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤
      document.querySelectorAll('.tab-button').forEach(btn => {
        btn.classList.remove('active');
      });

      // ã™ã¹ã¦ã®ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤º
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });

      // å¯¾å¿œã™ã‚‹ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã«activeã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
      const tabButton = document.querySelector(`.tab-button[onclick*="'${tabName}'"]`);
      if (tabButton) {
        tabButton.classList.add('active');
      }

      // å¯¾å¿œã™ã‚‹ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º
      document.getElementById('tab-' + tabName).classList.add('active');

      // ã‚¿ãƒ–çŠ¶æ…‹ã‚’ä¿å­˜
      if (saveState) {
        localStorage.setItem('admin_active_tab', tabName);
      }
    }

    // ä¿å­˜ã•ã‚ŒãŸã‚¿ãƒ–çŠ¶æ…‹ã‚’å¾©å…ƒ
    function restoreTab() {
      const savedTab = localStorage.getItem('admin_active_tab');
      if (savedTab) {
        const tabContent = document.getElementById('tab-' + savedTab);
        if (tabContent) {
          switchTab(savedTab, false);
        }
      }
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ã‚¿ãƒ–ã‚’å¾©å…ƒ
    document.addEventListener('DOMContentLoaded', restoreTab);

    // ========== ã“ã“ã¾ã§ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ ==========

    // ========== GitHub Pages ãƒ‡ãƒ—ãƒ­ã‚¤ãƒˆãƒªã‚¬ãƒ¼ ==========
    async function triggerDeploy() {
      const token = localStorage.getItem(GITHUB_TOKEN_KEY);
      if (!token) return;
      try {
        const response = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/actions/workflows/static.yml/dispatches`, {
          method: 'POST',
          headers: {
            'Authorization': `token ${token}`,
            'Accept': 'application/vnd.github.v3+json',
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ ref: GITHUB_BRANCH })
        });
        if (response.ok || response.status === 204) {
          console.log('Deploy triggered successfully');
        } else {
          console.error('Failed to trigger deploy:', response.status);
        }
      } catch (error) {
        console.error('Error triggering deploy:', error);
      }
    }


    // Enterã‚­ãƒ¼ã§ãƒ­ã‚°ã‚¤ãƒ³
    document.getElementById('passwordInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        login();
      }
    });

    // åˆæœŸåŒ–å®Ÿè¡Œ
    init();

  </script>
</body>
</html>
