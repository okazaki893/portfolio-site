<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Price</title>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-0VSVT7TT4R"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-0VSVT7TT4R');
  </script>
  <link rel="icon" type="image/png" href="images/favicon.png">
  <!-- OGP -->
  <meta property="og:title" content="Price - Noumenon">
  <meta property="og:description" content="料金表">
  <meta property="og:image" content="https://noumenon.jp/OGP.png">
  <meta property="og:url" content="https://noumenon.jp/price">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Price - Noumenon">
  <meta name="twitter:description" content="料金表">
  <meta name="twitter:image" content="https://noumenon.jp/OGP.png">
  <link rel="stylesheet" href="css/theme.css">
  <link rel="stylesheet" href="css/price.css">
</head>
<body>
  <div class="price-page">
    <!-- Hamburger Menu Button -->
    <div class="hamburger-menu" onclick="toggleMobileMenu()">
      <span></span>
      <span></span>
      <span></span>
    </div>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay">
      <ul class="mobile-menu-list">
        <li><a href="/">Top</a></li>
        <li><a href="works">Works</a></li>
        <li><a href="price" class="active">Price</a></li>
        <li><a href="contact">Contact</a></li>
      </ul>
    </div>

    <!-- Side menu -->
    <nav class="side-menu">
      <ul class="menu-list">
        <li class="menu-item">
          <span class="menu-bullet"></span>
          <span class="menu-line"></span>
          <a href="/" class="menu-link">Top</a>
        </li>
        <li class="menu-item">
          <span class="menu-bullet"></span>
          <span class="menu-line"></span>
          <a href="works" class="menu-link">Works</a>
        </li>
        <li class="menu-item">
          <span class="menu-bullet active"></span>
          <span class="menu-line"></span>
          <a href="price" class="menu-link active">Price</a>
        </li>
        <li class="menu-item">
          <span class="menu-bullet"></span>
          <a href="contact" class="menu-link">Contact</a>
        </li>
      </ul>
      <!-- Social Links -->
      <div class="social-icons">
        <a href="https://x.com/okazaki_yuki01" target="_blank" class="social-link">X (main)</a>
        <a href="https://x.com/DOSUKOI_JK" target="_blank" class="social-link">X (mix)</a>
        <a href="https://discord.com/users/528093170484117518" target="_blank" class="social-link">Discord</a>
        <a href="https://okazakiyuki.booth.pm/" target="_blank" class="social-link">BOOTH</a>
      </div>
    </nav>

    <!-- Animated gradient background -->
    <div class="gradient-bg"></div>

    <!-- Grid pattern overlay -->
    <div class="grid-pattern"></div>

    <!-- Floating orbs -->
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>

    <!-- Main content -->
    <div class="content">
      <h1 class="page-title">PRICE</h1>
      <p class="price-subtitle">歌ってみたMIX料金表</p>

      <!-- 基本料金 -->
      <div class="price-cards">
        <!-- Short -->
        <div class="price-card-wrapper">
          <div class="price-card tap-select" data-plan="Short" data-price="3000" onclick="tapCard(this)">
            <div class="card-header">
              <span class="plan-name">Short</span>
              <div class="price">
                <span class="currency">¥</span>
                <span class="amount">3,000</span>
                <span class="period">~</span>
              </div>
            </div>
            <div class="card-body">
              <ul class="features">
                <li>基本納期: 3日</li>
              </ul>
            </div>
          </div>
          <div class="qty-display" data-for="Short">
            <button type="button" class="qty-btn minus" onclick="changeQty('Short', -1, event)">-</button>
            <span class="qty-value">0</span>
            <button type="button" class="qty-btn plus" onclick="changeQty('Short', 1, event)">+</button>
          </div>
        </div>

        <!-- One Chorus -->
        <div class="price-card-wrapper">
          <div class="price-card tap-select" data-plan="One Chorus" data-price="5000" onclick="tapCard(this)">
            <div class="card-header">
              <span class="plan-name">One Chorus</span>
              <div class="price">
                <span class="currency">¥</span>
                <span class="amount">5,000</span>
                <span class="period">~</span>
              </div>
            </div>
            <div class="card-body">
              <ul class="features">
                <li>基本納期: 2週間</li>
              </ul>
            </div>
          </div>
          <div class="qty-display" data-for="One Chorus">
            <button type="button" class="qty-btn minus" onclick="changeQty('One Chorus', -1, event)">-</button>
            <span class="qty-value">0</span>
            <button type="button" class="qty-btn plus" onclick="changeQty('One Chorus', 1, event)">+</button>
          </div>
        </div>

        <!-- Full Chorus -->
        <div class="price-card-wrapper">
          <div class="price-card tap-select" data-plan="Full Chorus" data-price="8000" onclick="tapCard(this)">
            <div class="card-header">
              <span class="plan-name">Full Chorus</span>
              <div class="price">
                <span class="currency">¥</span>
                <span class="amount">8,000</span>
                <span class="period">~</span>
              </div>
            </div>
            <div class="card-body">
              <ul class="features">
                <li>基本納期: 2週間</li>
              </ul>
            </div>
          </div>
          <div class="qty-display" data-for="Full Chorus">
            <button type="button" class="qty-btn minus" onclick="changeQty('Full Chorus', -1, event)">-</button>
            <span class="qty-value">0</span>
            <button type="button" class="qty-btn plus" onclick="changeQty('Full Chorus', 1, event)">+</button>
          </div>
        </div>
      </div>

      <div class="price-note">
        <p>※ すべてのプランにピッチ補正、タイミング補正、ハモリ生成、マスタリングが含まれています</p>
      </div>

      <!-- 納期短縮オプション -->
      <h2 class="section-title">納期短縮オプション</h2>

      <div class="option-section delivery-section" id="deliveryStandard">
        <h3 class="option-subtitle">One Chorus / Full Chorus</h3>
        <div class="option-cards delivery-options four-cols" data-for="standard">
          <div class="option-card-wrapper">
            <div class="option-card tap-select" data-delivery="standard-2週間" data-price="0" onclick="tapDelivery(this, 'standard')">
              <span class="option-name">2週間</span>
              <span class="option-price">¥0</span>
            </div>
            <div class="qty-display small" data-for="standard-2週間">
              <button type="button" class="qty-btn minus" onclick="changeDeliveryQty('standard-2週間', -1, event)">-</button>
              <span class="qty-value">0</span>
              <button type="button" class="qty-btn plus" onclick="changeDeliveryQty('standard-2週間', 1, event)">+</button>
            </div>
          </div>
          <div class="option-card-wrapper">
            <div class="option-card tap-select" data-delivery="standard-1週間" data-price="1500" onclick="tapDelivery(this, 'standard')">
              <span class="option-name">1週間</span>
              <span class="option-price">+¥1,500</span>
            </div>
            <div class="qty-display small" data-for="standard-1週間">
              <button type="button" class="qty-btn minus" onclick="changeDeliveryQty('standard-1週間', -1, event)">-</button>
              <span class="qty-value">0</span>
              <button type="button" class="qty-btn plus" onclick="changeDeliveryQty('standard-1週間', 1, event)">+</button>
            </div>
          </div>
          <div class="option-card-wrapper">
            <div class="option-card tap-select" data-delivery="standard-3日" data-price="4000" onclick="tapDelivery(this, 'standard')">
              <span class="option-name">3日</span>
              <span class="option-price">+¥4,000</span>
            </div>
            <div class="qty-display small" data-for="standard-3日">
              <button type="button" class="qty-btn minus" onclick="changeDeliveryQty('standard-3日', -1, event)">-</button>
              <span class="qty-value">0</span>
              <button type="button" class="qty-btn plus" onclick="changeDeliveryQty('standard-3日', 1, event)">+</button>
            </div>
          </div>
          <div class="option-card-wrapper">
            <div class="option-card tap-select" data-delivery="standard-24時間以内" data-price="6000" onclick="tapDelivery(this, 'standard')">
              <span class="option-name">24時間以内</span>
              <span class="option-price">+¥6,000</span>
            </div>
            <div class="qty-display small" data-for="standard-24時間以内">
              <button type="button" class="qty-btn minus" onclick="changeDeliveryQty('standard-24時間以内', -1, event)">-</button>
              <span class="qty-value">0</span>
              <button type="button" class="qty-btn plus" onclick="changeDeliveryQty('standard-24時間以内', 1, event)">+</button>
            </div>
          </div>
        </div>
      </div>

      <div class="option-section delivery-section" id="deliveryShort">
        <h3 class="option-subtitle">Short</h3>
        <div class="option-cards delivery-options" data-for="short">
          <div class="option-card-wrapper">
            <div class="option-card tap-select" data-delivery="short-3日" data-price="0" onclick="tapDelivery(this, 'short')">
              <span class="option-name">3日</span>
              <span class="option-price">¥0</span>
            </div>
            <div class="qty-display small" data-for="short-3日">
              <button type="button" class="qty-btn minus" onclick="changeDeliveryQty('short-3日', -1, event)">-</button>
              <span class="qty-value">0</span>
              <button type="button" class="qty-btn plus" onclick="changeDeliveryQty('short-3日', 1, event)">+</button>
            </div>
          </div>
          <div class="option-card-wrapper">
            <div class="option-card tap-select" data-delivery="short-24時間以内" data-price="1000" onclick="tapDelivery(this, 'short')">
              <span class="option-name">24時間以内</span>
              <span class="option-price">+¥1,000</span>
            </div>
            <div class="qty-display small" data-for="short-24時間以内">
              <button type="button" class="qty-btn minus" onclick="changeDeliveryQty('short-24時間以内', -1, event)">-</button>
              <span class="qty-value">0</span>
              <button type="button" class="qty-btn plus" onclick="changeDeliveryQty('short-24時間以内', 1, event)">+</button>
            </div>
          </div>
        </div>
      </div>

      <!-- その他オプション -->
      <h2 class="section-title">その他オプション</h2>
      <div class="option-cards other-options">
        <div class="option-card-wrapper">
          <div class="option-card tap-select" data-option="カットアップ" data-price="2000" data-variable="true" onclick="tapOption(this)">
            <span class="option-name">カットアップ</span>
            <span class="option-price">¥2,000~</span>
          </div>
          <div class="qty-display small" data-for="カットアップ">
            <button type="button" class="qty-btn minus" onclick="changeOptionQty('カットアップ', -1, event)">-</button>
            <span class="qty-value">0</span>
            <button type="button" class="qty-btn plus" onclick="changeOptionQty('カットアップ', 1, event)">+</button>
          </div>
        </div>
        <div class="option-card-wrapper">
          <div class="option-card tap-select" data-option="エンコード" data-price="1000" onclick="tapOption(this)">
            <span class="option-name">エンコード</span>
            <span class="option-price">¥1,000</span>
          </div>
          <div class="qty-display small" data-for="エンコード">
            <button type="button" class="qty-btn minus" onclick="changeOptionQty('エンコード', -1, event)">-</button>
            <span class="qty-value">0</span>
            <button type="button" class="qty-btn plus" onclick="changeOptionQty('エンコード', 1, event)">+</button>
          </div>
        </div>
        <div class="option-card-wrapper">
          <div class="option-card tap-select" data-option="ハモリガイドメロ作成" data-price="3000" data-variable="true" onclick="tapOption(this)">
            <span class="option-name">ハモリガイドメロ作成</span>
            <span class="option-price">¥3,000~</span>
          </div>
          <div class="qty-display small" data-for="ハモリガイドメロ作成">
            <button type="button" class="qty-btn minus" onclick="changeOptionQty('ハモリガイドメロ作成', -1, event)">-</button>
            <span class="qty-value">0</span>
            <button type="button" class="qty-btn plus" onclick="changeOptionQty('ハモリガイドメロ作成', 1, event)">+</button>
          </div>
        </div>
      </div>

      <div class="price-note">
        <p>※ ハモリガイドメロ作成はハモリを歌唱したい方向けのオプションです（補正込み）</p>
      </div>

      <!-- 概算見積り金額表示 -->
      <div class="estimate-total" id="estimateTotal">
        <span class="estimate-label">概算見積り金額</span>
        <span class="estimate-amount" id="estimateAmount">¥0~</span>
      </div>
      <p class="estimate-note">※ トラック数や作業の工数によって金額が上下する場合があります</p>

      <!-- 依頼するボタン -->
      <div class="estimate-button-container">
        <a href="contact" class="estimate-btn" id="estimateBtn">依頼する</a>
      </div>
    </div>
  </div>

  <script>
    // 数量データを保持
    const quantities = {
      plans: {},
      delivery: {},
      options: {}
    };

    // プランカードをタップ
    function tapCard(card) {
      const plan = card.getAttribute('data-plan');
      quantities.plans[plan] = (quantities.plans[plan] || 0) + 1;
      updateDisplay(plan, quantities.plans[plan], '.price-card');
      calculateEstimate();
    }

    // プラン数量変更
    function changeQty(plan, delta, event) {
      event.stopPropagation();
      quantities.plans[plan] = Math.max(0, (quantities.plans[plan] || 0) + delta);
      updateDisplay(plan, quantities.plans[plan], '.price-card');
      calculateEstimate();
    }

    // 納期カードをタップ
    function tapDelivery(card, type) {
      const delivery = card.getAttribute('data-delivery');
      quantities.delivery[delivery] = (quantities.delivery[delivery] || 0) + 1;
      updateDisplay(delivery, quantities.delivery[delivery], '.option-card');
      calculateEstimate();
    }

    // 納期数量変更
    function changeDeliveryQty(delivery, delta, event) {
      event.stopPropagation();
      quantities.delivery[delivery] = Math.max(0, (quantities.delivery[delivery] || 0) + delta);
      updateDisplay(delivery, quantities.delivery[delivery], '.option-card');
      calculateEstimate();
    }

    // オプションカードをタップ
    function tapOption(card) {
      const option = card.getAttribute('data-option');
      quantities.options[option] = (quantities.options[option] || 0) + 1;
      updateDisplay(option, quantities.options[option], '.option-card');
      calculateEstimate();
    }

    // オプション数量変更
    function changeOptionQty(option, delta, event) {
      event.stopPropagation();
      quantities.options[option] = Math.max(0, (quantities.options[option] || 0) + delta);
      updateDisplay(option, quantities.options[option], '.option-card');
      calculateEstimate();
    }

    // 表示を更新
    function updateDisplay(key, value, cardSelector) {
      const display = document.querySelector(`.qty-display[data-for="${key}"] .qty-value`);
      if (display) {
        display.textContent = value;
      }
      // カードのselected状態を更新
      const card = document.querySelector(`${cardSelector}[data-plan="${key}"], ${cardSelector}[data-delivery="${key}"], ${cardSelector}[data-option="${key}"]`);
      if (card) {
        if (value > 0) {
          card.classList.add('selected');
        } else {
          card.classList.remove('selected');
        }
      }
    }

    // 見積金額計算
    function calculateEstimate() {
      let total = 0;
      let hasVariable = false;

      // プラン料金
      const planPrices = { 'Short': 3000, 'One Chorus': 5000, 'Full Chorus': 8000 };
      for (const [plan, qty] of Object.entries(quantities.plans)) {
        if (qty > 0) {
          total += (planPrices[plan] || 0) * qty;
        }
      }

      // 納期オプション料金
      for (const [delivery, qty] of Object.entries(quantities.delivery)) {
        if (qty > 0) {
          const card = document.querySelector(`.option-card[data-delivery="${delivery}"]`);
          if (card) {
            const price = parseInt(card.getAttribute('data-price')) || 0;
            total += price * qty;
          }
        }
      }

      // その他オプション料金
      for (const [option, qty] of Object.entries(quantities.options)) {
        if (qty > 0) {
          const card = document.querySelector(`.option-card[data-option="${option}"]`);
          if (card) {
            const price = parseInt(card.getAttribute('data-price')) || 0;
            const isVariable = card.getAttribute('data-variable') === 'true';
            total += price * qty;
            if (isVariable) {
              hasVariable = true;
            }
          }
        }
      }

      // 表示更新
      const display = document.getElementById('estimateAmount');
      if (total > 0) {
        display.textContent = '¥' + total.toLocaleString() + (hasVariable ? '~' : '');
      } else {
        display.textContent = '¥0~';
      }
    }

    // 依頼するボタンのリンクを動的に変更
    document.getElementById('estimateBtn').addEventListener('click', function(e) {
      e.preventDefault();

      // 選択されたプランを収集
      const plans = [];
      for (const [plan, qty] of Object.entries(quantities.plans)) {
        if (qty > 0) {
          plans.push(plan + ' x' + qty);
        }
      }

      // 選択された納期を収集
      const deliveries = [];
      for (const [delivery, qty] of Object.entries(quantities.delivery)) {
        if (qty > 0) {
          // "standard-2週間" -> "2週間" のように変換
          const name = delivery.split('-').slice(1).join('-');
          deliveries.push(name + ' x' + qty);
        }
      }

      // 選択されたオプションを収集
      const options = [];
      for (const [option, qty] of Object.entries(quantities.options)) {
        if (qty > 0) {
          options.push(option + ' x' + qty);
        }
      }

      var params = new URLSearchParams();
      if (plans.length > 0) {
        params.append('plan', plans.join(', '));
      }
      if (deliveries.length > 0) {
        params.append('delivery', deliveries.join(', '));
      }
      if (options.length > 0) {
        params.append('options', options.join(', '));
      }

      // 見積もり金額も追加
      const estimateAmount = document.getElementById('estimateAmount').textContent;
      params.append('estimate', estimateAmount);

      var queryString = params.toString();
      var url = 'contact.html' + (queryString ? '?' + queryString : '');

      window.location.href = url;
    });

    // Mobile menu toggle
    function toggleMobileMenu() {
      const hamburger = document.querySelector('.hamburger-menu');
      const overlay = document.getElementById('mobileMenuOverlay');
      hamburger.classList.toggle('active');
      overlay.classList.toggle('active');
    }
  </script>
</body>
</html>
